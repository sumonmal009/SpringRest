<!DOCTYPE html>
<!-- saved from url=(0075)http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/ -->
<html lang="en-US" prefix="og: http://ogp.me/ns#" class="gr__websystique_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Secure Spring REST API using OAuth2 - WebSystique</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://websystique.com/xmlrpc.php">

        <script async="" src="./Secure Spring REST API using OAuth2 - WebSystique_files/saved_resource"></script><script src="./Secure Spring REST API using OAuth2 - WebSystique_files/cb=gapi.loaded_1" async=""></script><script src="./Secure Spring REST API using OAuth2 - WebSystique_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Secure Spring REST API using OAuth2 - WebSystique_files/plusone.js.download" gapi_processed="true"></script><script type="text/javascript" async="" src="./Secure Spring REST API using OAuth2 - WebSystique_files/ga.js.download"></script><script type="text/javascript">
            var sdm_frontend_translations = {incorrect_password: 'Incorrect Password'};
        </script>
        
<!-- This site is optimized with the Yoast WordPress SEO plugin v2.1.1 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="A Guide to OAuth2, securing REST API using Spring OAuth2 support , showing how different clients can access the OAuth2 protected resources using tokens.">
<link rel="canonical" href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Secure Spring REST API using OAuth2 - WebSystique">
<meta property="og:description" content="A Guide to OAuth2, securing REST API using Spring OAuth2 support , showing how different clients can access the OAuth2 protected resources using tokens.">
<meta property="og:url" content="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/">
<meta property="og:site_name" content="WebSystique">
<meta property="article:author" content="https://www.facebook.com/websystique">
<meta property="article:section" content="spring-security">
<meta property="article:published_time" content="2016-07-30T20:52:53+00:00">
<meta property="article:modified_time" content="2016-11-14T23:26:18+00:00">
<meta property="og:updated_time" content="2016-11-14T23:26:18+00:00">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img1.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img2.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img3.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img4.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img5.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img6.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img7.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img8.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img9.png">
<meta property="og:image" content="http://websystique.com/wp-content/uploads/2016/07/SpringOAuth2_img10.png">
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","url":"http:\/\/websystique.com\/","name":"WebSystique"}</script>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WebSystique » Feed" href="http://websystique.com/feed/">
<link rel="alternate" type="application/rss+xml" title="WebSystique » Comments Feed" href="http://websystique.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="WebSystique » Secure Spring REST API using OAuth2 Comments Feed" href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/feed/">
<link rel="stylesheet" id="yarppWidgetCss-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/widget.css" type="text/css" media="all">
<link rel="stylesheet" id="sab-plugin-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/simple-author-box.min.css" type="text/css" media="all">
<link rel="stylesheet" id="sdm-styles-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/sdm_wp_styles.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-syntax-css-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/wp-syntax.css" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/dashicons.min.css" type="text/css" media="all">
<link rel="stylesheet" id="bizmo-style-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/font-awesome.min.css" type="text/css" media="all">
<!-- This site uses the Google Analytics by Yoast plugin v5.4.2 - Universal disabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-54200369-1']);
	_gaq.push(['_gat._forceSSL']);
	_gaq.push(['_trackPageview']);

	(function () {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();

</script>
<!-- / Google Analytics by Yoast -->
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/jquery.js.download"></script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/jquery-migrate.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var sdm_ajax_script = {"ajaxurl":"http:\/\/websystique.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/sdm_wp_scripts.js.download"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://websystique.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://websystique.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 3.9.14">
<link rel="shortlink" href="http://websystique.com/?p=2904">
<meta name="google-site-verification" content="67VeClHcExvY98DsAJbQEEkrMw8hgZfhtjkAQdNTZvQ"><style>
/* BODY */
#top-bar {background:#024959;}.current_page_item a, #masthead {background:#037E8C;}a,#colophon .site-info a {color:#F24C27;}#topbar-search button:hover,.main-navigation li:hover a,.main-navigation a:hover,.button,button,
input[type="button"],input[type="reset"],input[type="submit"] {background:#F24C27;}@media screen and (max-width: 600px) {.menu-toggle,#site-navigation li {background:#F24C27;}}.button:hover,button:hover,input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover {background:#c23d1f;}html,#colophon,#breadcrumbs-wrap {background:#024959;}</style>
<style type="text/css">.saboxplugin-wrap {border-color:#2fccff;}.saboxplugin-wrap .saboxplugin-socials {-webkit-box-shadow: 0 0.05em 0 0 #2fccff inset; -moz-box-shadow:0 0.05em 0 0 #2fccff inset;box-shadow:0 0.05em 0 0 #2fccff inset;}.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-color {-webkit-border-radius:50%;-moz-border-radius:50%;-ms-border-radius:50%;-o-border-radius:50%;border-radius:50%;}.saboxplugin-wrap .saboxplugin-socials{background-color:#2fccff;}.saboxplugin-wrap {margin-top:0px;}.saboxplugin-wrap {margin-bottom:0px;}.saboxplugin-wrap .saboxplugin-authorname {font-size:18px; line-height:25px;}.saboxplugin-wrap .saboxplugin-desc {font-size:14px; line-height:21px;}.saboxplugin-wrap .saboxplugin-web {font-size:14px;}.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-color {font-size:21px;}.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-color:before {width:36px; height:36px; line-height:37px; }.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-grey {font-size:18px;}</style><link rel="stylesheet" type="text/css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<meta data-pso-pv="1.2.1" data-pso-pt="singlePost" data-pso-th="1a9008d1141413a3a7d287505f36412b"><script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script pagespeed_no_defer="" data-pso-version="20161208_000714">window.dynamicgoogletags={config:[]};dynamicgoogletags.config=["ca-pub-6696898840465221",[[[["DIV",,"secondary",[]],["10px","10px",0],2,[0],"9313790394",0],[["ARTICLE",0,,[],2],["10px","18px",0],0,[0],"7269583195",0]]],[[[],[[["BODY",0,,[]],["10px","10px",1],1,[4],,0,,,2],[["NAV",0,,[]],["10px","10px",1],0,[4],,0,,,5],[["NAV",0,,[]],["10px","10px",1],3,[4],,0,,,5],[["HEADER",0,,[]],["10px","10px",1],0,[4],,0,,,4],[["DIV",,"primary",[]],["10px","10px",1],0,[2],,0,,,5],[["DIV",,"disqus_thread",[]],["10px","22.5px",0],0,[1],,0,,,7],[["DIV",,"disqus_thread",[]],["10px","10px",0],3,[1],,0,,,7],[["DIV",,,["site-info"]],["10px","10px",0],0,[3],,0,,,5],[["DIV",,,["site-info"]],["10px","10px",0],3,[5],,0,,,5],[["BODY",0,,[]],["10px","10px",1],2,[5],,0,,,2],[["ARTICLE",0,,[],1],["10px","22.5px",0],0,[0],,0,,,9],[["ARTICLE",0,,[],2],["10px","22.5px",0],0,[0],,0,,,9],[["ARTICLE",0,,[],-1],["5px","12px",0],3,[0],,0,,,13],[["ASIDE",,"google-badge-box-2",[]],["10px","48px",0],3,[3],,0,,,6],[["DIV",,"page",[]],["10px","10px",0],3,[5],,0,,,3],[["ARTICLE",0,,[],3],["10px","10px",0],0,[0],,0,,,9],[["ASIDE",,"adswidget1-quick-adsense",[]],["10px","48px",0],0,[3],,0,,,6]],["1723144791","3199877992","4676611191","6153344392","7630077593"],["ARTICLE",,,[]],"20161208_040724",6]],"WordPressSinglePost","3686059196",,0.01,,[,1482543593674],0.01,1,,,"http://websystique.com"];(function(){var h=this,aa=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},n=function(a){return"number"==typeof a},ba=function(a,b,c){return a.call.apply(a.bind,arguments)},ca=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}},da=function(a,b,c){da=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?
ba:ca;return da.apply(null,arguments)},ea=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}},fa=Date.now||function(){return+new Date},r=function(a,b){function c(){}c.prototype=b.prototype;a.La=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Na=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};var ga=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},ha=function(a,b){return a<b?-1:a>b?1:0},ia=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};var ja=Array.prototype.map?function(a,b,c){return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f="string"==typeof a?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};var la=function(a){ka();this.enabled=Math.random()<a;this.events=[]},ka=h.performance&&h.performance.now?da(h.performance.now,h.performance):fa;la.prototype.install=function(a){a=a||window;a.google_js_reporting_queue=a.google_js_reporting_queue||[];this.events=a.google_js_reporting_queue};var ma=function(a){ma[" "](a);return a};ma[" "]=function(){};var oa=function(a,b){var c=na;Object.prototype.hasOwnProperty.call(c,a)||(c[a]=b(a))};var qa=function(){var a=pa;try{var b;if(b=!!a&&null!=a.location.href)a:{try{ma(a.foo);b=!0;break a}catch(c){}b=!1}return b}catch(c){return!1}},ra=function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.call(void 0,a[c],c,a)};(function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b)}catch(c){}return a})();var sa=function(a,b,c,d,e){this.ga=c||4E3;this.H=a||"&";this.sa=b||",$";this.R=void 0!==d?d:"trn";this.Ma=e||null;this.ra=!1;this.T={};this.Ea=0;this.L=[]},va=function(a,b,c,d){b=b+"//"+c+d;var e=ta(a)-d.length-0;if(0>e)return"";a.L.sort(function(a,b){return a-b});d=null;c="";for(var f=0;f<a.L.length;f++)for(var g=a.L[f],k=a.T[g],m=0;m<k.length;m++){if(!e){d=null==d?g:d;break}var l=ua(k[m],a.H,a.sa);if(l){l=c+l;if(e>=l.length){e-=l.length;b+=l;c=a.H;break}else a.ra&&(c=e,l[c-1]==a.H&&--c,b+=l.substr(0,
c),c=a.H,e=0);d=null==d?g:d}}f="";a.R&&null!=d&&(f=c+a.R+"="+(a.Ma||d));return b+f+""},ta=function(a){if(!a.R)return a.ga;var b=1,c;for(c in a.T)b=c.length>b?c.length:b;return a.ga-a.R.length-b-a.H.length-1},ua=function(a,b,c,d,e){var f=[];ra(a,function(a,k){(a=wa(a,b,c,d,e))&&f.push(k+"="+a)});return f.join(b)},wa=function(a,b,c,d,e){if(null==a)return"";b=b||"&";c=c||",$";"string"==typeof c&&(c=c.split(""));if(a instanceof Array){if(d=d||0,d<c.length){for(var f=[],g=0;g<a.length;g++)f.push(wa(a[g],
b,c,d+1,e));return f.join(c[d])}}else if("object"==typeof a)return e=e||0,2>e?encodeURIComponent(ua(a,b,c,d,e+1)):"...";return encodeURIComponent(String(a))};var za=function(a,b,c,d){var e=xa;if((c?e.Ja:Math.random())<(d||e.ua))try{var f;b instanceof sa?f=b:(f=new sa,ra(b,function(a,b){var c=f,d=c.Ea++,e={};e[b]=a;a=[e];c.L.push(d);c.T[d]=a}));var g=va(f,e.Ha,e.wa,e.Ga+a+"&");g&&ya(g)}catch(k){}},ya=function(a){h.google_image_requests||(h.google_image_requests=[]);var b=h.document.createElement("img");b.src=a;h.google_image_requests.push(b)};var t;a:{var Aa=h.navigator;if(Aa){var Ba=Aa.userAgent;if(Ba){t=Ba;break a}}t=""}var u=function(a){return-1!=t.indexOf(a)};var Ca=u("Opera"),v=u("Trident")||u("MSIE"),Da=u("Edge"),Ea=u("Gecko")&&!(-1!=t.toLowerCase().indexOf("webkit")&&!u("Edge"))&&!(u("Trident")||u("MSIE"))&&!u("Edge"),Fa=-1!=t.toLowerCase().indexOf("webkit")&&!u("Edge"),Ga=function(){var a=h.document;return a?a.documentMode:void 0},Ha;
a:{var Ia="",Ja=function(){var a=t;if(Ea)return/rv\:([^\);]+)(\)|;)/.exec(a);if(Da)return/Edge\/([\d\.]+)/.exec(a);if(v)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(Fa)return/WebKit\/(\S+)/.exec(a);if(Ca)return/(?:Version)[ \/]?(\S+)/.exec(a)}();Ja&&(Ia=Ja?Ja[1]:"");if(v){var Ka=Ga();if(null!=Ka&&Ka>parseFloat(Ia)){Ha=String(Ka);break a}}Ha=Ia}
var La=Ha,na={},Ma=function(a){oa(a,function(){for(var b=0,c=ga(String(La)).split("."),d=ga(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"";do{g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];k=/(\d*)(\D*)(.*)/.exec(k)||["","","",""];if(0==g[0].length&&0==k[0].length)break;b=ha(0==g[1].length?0:parseInt(g[1],10),0==k[1].length?0:parseInt(k[1],10))||ha(0==g[2].length,0==k[2].length)||ha(g[2],k[2]);g=g[3];k=k[3]}while(0==b)}return 0<=b})},Na;var Oa=h.document;
Na=Oa&&v?Ga()||("CSS1Compat"==Oa.compatMode?parseInt(La,10):5):void 0;var x=function(){},Pa="function"==typeof Uint8Array,z=function(a,b,c){a.a=null;b||(b=[]);a.Pa=void 0;a.M=-1;a.l=b;a:{if(a.l.length){b=a.l.length-1;var d=a.l[b];if(d&&"object"==typeof d&&"array"!=aa(d)&&!(Pa&&d instanceof Uint8Array)){a.P=b-a.M;a.G=d;break a}}a.P=Number.MAX_VALUE}a.Oa={};if(c)for(b=0;b<c.length;b++)d=c[b],d<a.P?(d+=a.M,a.l[d]=a.l[d]||y):a.G[d]=a.G[d]||y},y=[],A=function(a,b){if(b<a.P){b+=a.M;var c=a.l[b];return c===y?a.l[b]=[]:c}c=a.G[b];return c===y?a.G[b]=[]:c},Ra=function(a){a=
A(Qa,a);return null==a?a:+a},B=function(a,b,c){b<a.P?a.l[b+a.M]=c:a.G[b]=c},C=function(a,b,c){a.a||(a.a={});if(!a.a[c]){var d=A(a,c);d&&(a.a[c]=new b(d))}return a.a[c]},D=function(a,b,c){a.a||(a.a={});if(!a.a[c]){for(var d=A(a,c),e=[],f=0;f<d.length;f++)e[f]=new b(d[f]);a.a[c]=e}b=a.a[c];b==y&&(b=a.a[c]=[]);return b},Sa=function(a,b,c){a.a||(a.a={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=E(c[e]);a.a[b]=c;B(a,b,d)},Ta=function(a){if(a.a)for(var b in a.a){var c=a.a[b];if("array"==aa(c))for(var d=
0;d<c.length;d++)c[d]&&E(c[d]);else c&&E(c)}},E=function(a){Ta(a);return a.l};x.prototype.toString=function(){Ta(this);return this.l.toString()};var Ua=function(a){var b;if("array"==aa(a)){for(var c=Array(a.length),d=0;d<a.length;d++)null!=(b=a[d])&&(c[d]="object"==typeof b?Ua(b):b);return c}if(Pa&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(d in a)null!=(b=a[d])&&(c[d]="object"==typeof b?Ua(b):b);return c};var Va;if(!(Va=!Ea&&!v)){var Wa;if(Wa=v)Wa=9<=Number(Na);Va=Wa}Va||Ea&&Ma("1.9.1");v&&Ma("9");var F=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};F.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};var Xa=document,Ya=window;var Za=!!window.google_async_iframe_id,pa=Za&&window.parent||window;var xa,$a=new la(1);xa=new function(){this.Ha="http:"===Ya.location.protocol?"http:":"https:";this.wa="pagead2.googlesyndication.com";this.Ga="/pagead/gen_204?id=";this.ua=.01;this.Ja=Math.random()};$a.install(function(){if(Za&&!qa()){var a="."+Xa.domain;try{for(;2<a.split(".").length&&!qa();)Xa.domain=a=a.substr(a.indexOf(".")+1),pa=window.parent}catch(b){}qa()||(pa=window)}return pa}());var G=function(a){this.ja={};this.ja.c=a;this.o=[];this.u=null;this.v=[];this.ba=0};G.prototype.g=function(a){for(var b=0;b<this.o.length;b++)if(this.o[b]==a)return this;this.o.push(a);return this};var ab=function(a,b){a.u=a.u?a.u:b;return a};G.prototype.C=function(a){for(var b=0;b<this.v.length;b++)if(this.v[b]==a)return this;this.v.push(a);return this};
G.prototype.getData=function(a){var b=this.ja,c={},d;for(d in b)c[d]=b[d];0<this.ba&&(c.t=this.ba);c.err=this.o.join();c.warn=this.v.join();if(this.u){c.excp_n=this.u.name;c.excp_m=this.u.message&&this.u.message.substring(0,512);if(b=this.u.stack){d=this.u.stack;try{-1==d.indexOf("")&&(d="\n"+d);for(var e;d!=e;)e=d,d=d.replace(/((https?:\/..*\/)[^\/:]*:\d+(?:.|\n)*)\2/,"$1");b=d.replace(/\n */g,"\n")}catch(f){b=""}}c.excp_s=b}c.w=0<a.innerWidth?a.innerWidth:null;c.h=0<a.innerHeight?a.innerHeight:
null;return c};var cb=function(a,b){bb(a,a.za,a.V,b)},bb=function(a,b,c,d){var e=d.u;d=d.getData(a.K);a.Ba?(d.type=b,a.K.console.log(d),e&&a.K.console.error(e)):0<c&&(d.r=c,za(b,d,"jserror"!=b,c))};var H=function(a){return a.dynamicgoogletags=a.dynamicgoogletags||{}};var I=function(a){z(this,a,db)};r(I,x);var db=[4];I.prototype.getId=function(){return A(this,3)};var J=function(a){z(this,a,null)};r(J,x);var eb=function(a){z(this,a,null)};r(eb,x);var K=function(a){return C(a,I,1)},L=function(a){z(this,a,fb)};r(L,x);var fb=[1];L.prototype.i=function(){return D(this,eb,1)};L.prototype.la=function(a){Sa(this,1,a)};var M=function(a){z(this,a,gb)};r(M,x);var gb=[2];M.prototype.fa=function(){return A(this,3)};M.prototype.ma=function(a){B(this,3,a)};var hb=function(a){z(this,a,null)};r(hb,x);var N=function(a){z(this,a,ib)};r(N,x);var ib=[1,2,3];N.prototype.i=function(){return D(this,eb,2)};
N.prototype.la=function(a){Sa(this,2,a)};var O=function(a){z(this,a,jb)};r(O,x);var jb=[3];O.prototype.A=function(){return A(this,1)};O.prototype.D=function(){return C(this,L,2)};O.prototype.O=function(){return A(this,4)};O.prototype.fa=function(){return A(this,5)};O.prototype.ma=function(a){B(this,5,a)};O.prototype.N=function(){return C(this,kb,9)};var kb=function(a){z(this,a,null)};r(kb,x);var lb=function(a){this.m=a;this.oa=[]};lb.prototype.f=function(){return 0<D(this.m,N,3).length?D(this.m,N,3)[0]:null};var mb=function(a){var b=["adsbygoogle-placeholder"];a=a.className?a.className.split(/\s+/):[];for(var c={},d=0;d<a.length;++d)c[a[d]]=!0;for(d=0;d<b.length;++d)if(!c[b[d]])return!1;return!0};var nb=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=ia(d.Qa);a[e]=d.value}},pb=function(a,b){b.setAttribute("data-adsbygoogle-status","reserved");b={element:b};ob(a).push(b)},ob=function(a){return a.adsbygoogle=a.adsbygoogle||[]};var qb=function(a,b){if(!a)return!1;a=b.getComputedStyle?b.getComputedStyle(a,null):a.currentStyle;if(!a)return!1;a=a.cssFloat||a.styleFloat;return"left"==a||"right"==a},rb=function(a){for(a=a.previousSibling;a&&1!=a.nodeType;)a=a.previousSibling;return a?a:null},sb=function(a){return!!a.nextSibling||!!a.parentNode&&sb(a.parentNode)};var tb=function(a,b){var c=a.length;if(null!=c)for(var d=0;d<c;d++)b.call(void 0,a[d],d)};var ub=function(a,b,c,d){this.Da=a;this.ha=b;this.ia=c;this.X=d};ub.prototype.query=function(a){var b=[];try{b=a.querySelectorAll(this.Da)}catch(f){}if(!b.length)return[];a=b;b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];a=c}else a=[];n(this.ha)&&(b=this.ha,0>b&&(b+=a.length),a=0<=b&&b<a.length?[a[b]]:[]);if(n(this.ia)){b=[];for(c=0;c<a.length;c++){var d=vb(a[c]),e=this.ia;0>e&&(e+=d.length);0<=e&&e<d.length&&b.push(d[e])}a=b}return a=wb(this,a)};
var wb=function(a,b){if(null==a.X)return b;switch(a.X){case 1:return b.slice(1);case 2:return b.slice(0,b.length-1);case 3:return b.slice(1,b.length-1);case 0:return b;default:throw Error("Unknown ignore mode: "+a.X);}},vb=function(a){var b=[];tb(a.getElementsByTagName("p"),function(a){100<=xb(a)&&b.push(a)});return b},xb=function(a){if(3==a.nodeType)return a.length;if(1!=a.nodeType||"SCRIPT"==a.tagName)return 0;var b=0;tb(a.childNodes,function(a){b+=xb(a)});return b},yb=function(a){return 0==a.length||
isNaN(a[0])?a:"\\"+(30+parseInt(a[0],10))+" "+a.substring(1)};var zb=function(a,b){var c=0,d=A(a,6);if(void 0!==d)switch(d){case 0:c=1;break;case 1:c=2;break;case 2:c=3}var d=null,e=A(a,7);if(A(a,1)||a.getId()||0<A(a,4).length){var f=a.getId(),g=A(a,1),e=A(a,4),d=A(a,2);a=A(a,5);var k="";g&&(k+=g);f&&(k+="#"+yb(f));if(e)for(f=0;f<e.length;f++)k+="."+yb(e[f]);d=(e=k)?new ub(e,d,a,c):null}else e&&(d=new ub(e,A(a,2),A(a,5),c));return d?d.query(b||document):[]},Ab=function(a,b){if(a==b)return!0;if(!a||!b||A(a,1)!=A(b,1)||A(a,2)!=A(b,2)||a.getId()!=b.getId()||A(a,
7)!=A(b,7)||A(a,5)!=A(b,5)||A(a,6)!=A(b,6))return!1;a=A(a,4);b=A(b,4);if(a||b)if(a&&b&&a.length==b.length)for(var c=0;c<a.length;c++){if(a[c]!=b[c])return!1}else return!1;return!0};var Bb=function(a){a=a.document;return("CSS1Compat"==a.compatMode?a.documentElement:a.body)||{}},Db=function(a){return void 0===a.pageYOffset?(a.document.documentElement||a.document.body.parentNode||a.document.body).scrollTop:a.pageYOffset};var Eb=function(a,b){b=K(b);if(!b)return null;a=zb(b,a);return 0<a.length?a[0]:null},Gb=function(a,b){b=Fb(a,b,!0);return n(b)&&!(b<=Bb(a).clientHeight)},Hb=function(a,b){return a.body?b-a.body.getBoundingClientRect().top:b},Fb=function(a,b,c){if(!c||!n(A(b,8))){var d=Eb(a.document,b);if(d){var e=null!=C(b,J,2)?A(C(b,J,2),3):void 0;c=window.document.createElement("div");c.className="googlepublisherpluginad";var f=c.style;f.textAlign="center";f.width="100%";f.height="0px";f.clear=e?"both":"none";Ib(c,
d,A(b,3));d=c.getBoundingClientRect().top+Db(a);c.parentNode.removeChild(c);B(b,8,d)}}b=A(b,8);return n(b)?b-Db(a):null},Jb={0:0,1:1,2:2,3:3},Kb={0:"auto",1:"horizontal",2:"vertical",3:"rectangle"},Lb=function(a,b){a.sort(function(a,d){a=Fb(b,a,!0);a=n(a)?a:Number.POSITIVE_INFINITY;d=Fb(b,d,!0);d=n(d)?d:Number.POSITIVE_INFINITY;return a-d})},Ib=function(a,b,c){switch(Jb[c]){case 0:b.parentNode&&b.parentNode.insertBefore(a,b);break;case 3:if(c=b.parentNode){var d=b.nextSibling;if(d&&d.parentNode!=
c)for(;d&&8==d.nodeType;)d=d.nextSibling;c.insertBefore(a,d)}break;case 1:b.insertBefore(a,b.firstChild);break;case 2:b.appendChild(a)}if(1!=b.nodeType?0:"INS"==b.tagName&&mb(b))b.style.display="block"};var P=function(a){this.b=a;this.j=[];this.aa=0;this.o=[];this.v=[];this.W=null;this.ka=!1},Mb=function(a,b){a=C(a.f(),I,4);if(!(a&&b&&A(b,1)==A(a,1)&&b.getId()==a.getId()&&n(A(b,2))&&n(A(b,5))))return!1;a=A(a,4);b=A(b,4);if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(b[c]!=a[c])return!1;return!0},Nb=function(a){var b=n(void 0)?void 0:20,c=a.f(),d=c.i(),e=C(c,I,4);if(!(a.ka||0>=b)&&e&&0!=zb(e,a.b.document).length){a.ka=!0;for(var c=[],f=0;f<d.length;++f){var g=d[f],k=K(g);if(Mb(a,k)){var m=
A(k,2),k=A(k,5);null!=m&&null!=k&&0<=m&&0<=k&&(!c[m]||A(K(c[m]),5)<k)&&(c[m]=g)}}k=0;d=zb(e,a.b.document);for(m=0;m<c.length&&k<b;++m){var e=k,f=a,l=d[m],g=c[m],k=b-k,p=f.f().i(),q=0;if(l&&g){l=vb(l).length;switch(A(K(g),6)){case 0:case 1:--l;break;case 2:l-=2}for(var w=A(K(g),5)+1;w<l&&q<k;++w){var Cb=new g.constructor(Ua(E(g))),Hc=K(Cb);B(Hc,5,w);p.push(Cb);q++}}q&&f.f().la(p);k=e+q}}};P.prototype.g=function(a){for(var b=0;b<this.o.length;++b)if(this.o[b]==a)return;this.o.push(a)};
P.prototype.C=function(a){for(var b=0;b<this.v.length;++b)if(this.v[b]==a)return;this.v.push(a)};
var Ob=function(a,b,c){var d=Jb[A(b,3)],e=Eb(a.b.document,b);if(e){var f=K(b)?A(K(b),2):void 0,g;a:{g=a.b;if(null!=f)switch(d){case 0:g=qb(rb(e),g);break a;case 3:g=qb(e,g);break a;case 2:f=e.lastChild;g=qb(f?1==f.nodeType?f:rb(f):null,g);break a}g=!1}if(!g&&(c||2!=d||sb(e))&&(c=1==d||2==d?e:e.parentNode,!c||(1!=c.nodeType?0:"INS"==c.tagName&&mb(c))||!(0>=c.offsetWidth)))a:if(A(b,7))a.C(8);else{b:if(A(b,5))c=A(b,5);else{if(c=Q(a).f())if(c=A(c,3),a.aa<c.length){c=c[a.aa++];break b}a.g(4);c=null}if(null!=
c){B(b,7,!0);d=[];(g=a.O())&&d.push(g);g=Q(a).oa;for(f=0;f<g.length;++f)d.push(g[f]);n(A(b,9))&&d.push("pso-lv-"+A(b,9));var k=a.b.document;g=a.A();var f=A(b,6),f=null!=f?Kb[f]:f,m=C(b,J,2),l={};m&&(l.na=A(m,1),l.da=A(m,2),l.ta=!!A(m,3));var m=c,p=k.createElement("div"),q=p.style;q.textAlign="center";q.width="100%";q.height="auto";q.clear=l.ta?"both":"none";l.Fa&&nb(q,l.Fa);k=k.createElement("ins");q=k.style;q.display="block";q.margin="auto";q.backgroundColor="transparent";l.na&&(q.marginTop=l.na);
l.da&&(q.marginBottom=l.da);l.pa&&nb(q,l.pa);p.appendChild(k);k.setAttribute("data-ad-format",f?f:"auto");p.className="googlepublisherpluginad";k.className="adsbygoogle";k.setAttribute("data-ad-client",g);k.setAttribute("data-tag-origin","pso");m&&k.setAttribute("data-ad-slot",m);d.length&&k.setAttribute("data-ad-channel",d.join("+"));Ib(p,e,A(b,3));try{pb(a.b,k)}catch(w){A(b,5)!=c&&a.aa--;B(b,7,!1);a.C(6);p&&p.parentNode&&p.parentNode.removeChild(p);break a}a.j.push(p)}}}},Pb=function(a,b){for(var c=
Number.POSITIVE_INFINITY,d=0;d<a.j.length;++d)var e=a.j[d].getBoundingClientRect().top,f=a.j[d].getBoundingClientRect().bottom,c=Math.min(c,b<e?e-b:f<b?b-f:0);return c},Q=function(a){a=H(a.b).ps||null;if(!a)throw Error("No placementState");return a},Qb=function(a,b){var c=Q(a).m;if(!c||!c.A())return a.g(5),!1;c=D(c,N,3)[0];return c?A(c,3).length<b?(a.g(4),a.g(5),!1):!0:(a.g(5),!1)};P.prototype.A=function(){return Q(this).m.A()||""};P.prototype.O=function(){return Q(this).m.O()||void 0};
P.prototype.D=function(){return Q(this).m.D()||new L};P.prototype.f=function(){var a=Q(this).f();if(!a)throw Error("No mConfig");return a};var Rb=function(a){a=A(a.f(),6);return null!=a&&0<a};var Sb=function(){this.I=this.J=this.Z=null};var R=function(a){P.call(this,a)};r(R,P);R.prototype.apply=function(a){var b;(b=Q(this).m)&&b.A()&&b.D()?b=!0:(this.g(5),b=!1);if(b){b=this.D().i();for(var c=0;c<b.length;c++){var d=b[c];A(d,7)||Ob(this,d,a)}}};R.prototype.B=function(){return(0==this.D().i().length||0<this.j.length)&&0==this.o.length};var Tb=function(a){P.call(this,a);if(Qb(this,0)){a=this.D().i();for(var b=this.f().i(),c=0;c<a.length;c++){var d=a[c],e;a:{e=d;var f=b;if(e&&K(e))for(var g=0;g<f.length;g++){var k=f[g];if(A(e,3)==A(k,3)&&Ab(K(e),K(k))){e=k;break a}}e=null}e&&C(e,J,2)&&(e=C(e,J,2),d.a||(d.a={}),f=e?E(e):e,d.a[2]=e,B(d,2,f))}}};r(Tb,R);var Vb=function(a,b){var c=void 0===b.pageXOffset?(b.document.documentElement||b.document.body.parentNode||b.document.body).scrollLeft:b.pageXOffset,d=Db(b);if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),Ub(a)?new F(a.top+d,a.right+c,a.bottom+d,a.left+c):new F(0,0,0,0);b=b.document.createRange();b.selectNodeContents(a);return b.collapsed?new F(0,0,0,0):b.getBoundingClientRect?(a=b.getBoundingClientRect(),Ub(a)?new F(a.top+d,a.right+c,a.bottom+d,a.left+c):new F(0,0,0,0)):new F(0,0,0,
0)},Ub=function(a){return!!a&&n(a.top)&&!isNaN(a.top)&&n(a.right)&&!isNaN(a.right)&&n(a.bottom)&&!isNaN(a.bottom)&&n(a.left)&&!isNaN(a.left)};var Wb=function(a){var b=a.googletag;if(!b||"function"!=typeof b.pubads)return S("div[id^=div-gpt-ad]",a);var c=[];try{for(var d=b.pubads().getSlots(),b=0;b<d.length;b++){var e=d[b].getSlotElementId(),f=a.document.getElementById(e);null!=f&&c.push(f)}}catch(g){za("ladd_evt",{ok:0,err:g.toString()},!0,.1)}return c},Xb=function(a){return S("iframe[id^=aswift_],iframe[id^=google_ads_frame]",a)},S=function(a,b){return ja(b.document.querySelectorAll(a),function(a){return a})},$b=function(a){this.K=a;this.Aa=
Wb(a);this.qa=S("ins.adsbygoogle",a);this.ca=Xb(a);this.Ia=S("[__lsu_res=reserved]",a);this.S=[];a=Yb(this);for(var b=0;b<a.length;b++)this.S.push(new Zb(a[b]))},Yb=function(a){return[].concat(a.Aa,a.qa,a.ca,a.Ia)},Zb=function(a){this.xa=a;this.U=null};var T=function(a){P.call(this,a)};r(T,P);T.prototype.apply=function(){};T.prototype.B=function(){var a;if(Rb(this)){var b=this.b;a=Wb(b);var c=S("ins.adsbygoogle",b),d=Xb(b),b=S("[__lsu_res=reserved]",b);a=0<[].concat(a,c,d,b).length}else a=!0;return a};var ac=function(a){P.call(this,a);this.F=null};r(ac,P);
ac.prototype.apply=function(a){if(a&&Qb(this,2)){Nb(this);a=Bb(this.b).clientHeight||640;null==this.F&&(this.F=new $b(this.b));var b=this.F.ca.length;if(!(5<=b)){var b=Math.min(2,5-b),c=this.f().i();Lb(c,this.b);for(var d=0;d<c.length&&this.j.length<b;++d){var e=c[d];if(Gb(this.b,e)){var f=Fb(this.b,e,!0);if(void 0!==f){var g;a:{g=this.F;for(var k=a,m=f,l=0;l<g.S.length;l++){var p=m,q=k,w;w=g.S[l];w.U||(w.U=Vb(w.xa,g.K));w=w.U;if(w.top-q<p&&p<w.bottom+q){g=!0;break a}}g=!1}g||Pb(this,f)<a||Ob(this,
e,!0)}}}0==this.j.length&&this.C(1)}}};ac.prototype.B=function(){return Rb(this)?0<Yb(this.F).length:!0};var bc=function(a){P.call(this,a);this.Y=!1};r(bc,T);
bc.prototype.apply=function(a){if(a&&!this.Y){var b;a:{var c=this.b.document;b=c.body;if(a&&b){a=this.A();var d=c.createElement("div");d.className="googlepublisherpluginad";d.style.display="block";c=c.createElement("ins");c.className="adsbygoogle";c.setAttribute("data-ad-client",a);c.setAttribute("data-reactive-ad-format","1");c.setAttribute("data-tag-origin","pso");c.style.display="none";d.appendChild(c);Ib(d,b,2);try{pb(this.b,c)}catch(e){this.C(6);d&&d.parentNode&&d.parentNode.removeChild(d);b=
5;break a}this.j.push(d);b=0}else b=4}this.Y=0==b}};bc.prototype.B=function(){return this.Y&&T.prototype.B.call(this)};var cc=function(a){P.call(this,a);a=Bb(a).clientHeight;this.va=.1*a;this.Ca=.75*a};r(cc,P);
cc.prototype.apply=function(a){if(Qb(this,3)&&!this.B()){Nb(this);var b=this.f().i();Lb(b,this.b);var c;c=this.va;var d;d=document;d=d.querySelectorAll?d.querySelectorAll("header,#header,#masthead,.header,.site-header"):[];for(var e=d.length,f=0<e?d[0]:null,g=1;g<e;g++)d[g].getBoundingClientRect().top<f.getBoundingClientRect().top&&(f=d[g]);(d=f)&&(d=d.getBoundingClientRect())&&d.top!=d.bottom&&d.left!=d.right&&(c=Math.min(c,Hb(document,d.bottom)));for(d=0;d<b.length&&3>this.j.length;d++){e=b[d];
var f=c,g=this.b.document,k=Fb(this.b,e,!1);!n(k)||Hb(g,k)<f?f=!1:(f=Pb(this,k),f=this.Ca<f);f&&(f=Gb(this.b,e),g=A(e,6)||0,f&&0==g&&B(e,6,3),!f&&a||Ob(this,e,a))}}};cc.prototype.B=function(){return 3==this.j.length};var U={};U[16]=R;U[17]=R;U[19]=T;U[29]=ac;U[33]=T;U[30]=bc;U[28]=cc;U[34]=cc;U[32]=Tb;U[1]=R;U[8]=T;U[11]=R;var dc=[19,29,33,30,16,32,17,34],ec=[16,19,33,30,17,1,6,8,11];var fc=function(a,b){a=a.google_ad_modifications=a.google_ad_modifications||{};(a.ad_channels=a.ad_channels||[]).push(b)};var gc=function(a){return 0>a||99<a?null:10>a?"0"+a:""+a};var hc=function(a,b){a=a.google_ad_modifications=a.google_ad_modifications||{};a=a.loeids=a.loeids||[];for(var c=0;c<b.length;c++)a.push(b[c])};var ic=function(a,b,c){this.ea=a;this.ya=c?c:new kb};ic.prototype.N=function(){return this.ya||new kb};var jc=function(a){if(!n(a))return!1;for(var b=0;b<dc.length;++b)if(a==dc[b])return!1;return!0},oc=function(){var a=V,b=kc,c=lc,d=b.f();if(!d)return mc(16);var e=null,f;a:{var g=D(d,M,1);for(f=0;f<g.length;++f){for(var k=!0,m=0;m<ec.length;++m)A(g[f],4)==ec[m]&&(k=!1);if(k){g=[];0==d.i().length&&g.push("PsoInvalidVariant");0==A(d,3).length&&g.push("PsoNoAdSlotCodes");f=g;break a}}f=[]}g=c.ea;if(0==f.length)a:{e=D(d,M,1);if(n(g))for(f=0;f<e.length;f++)if(k=e[f],U[A(k,4)])for(var m=D(k,hb,2),l=0;l<
m.length;l++){var p=m[l],q=A(p,1),p=A(p,2);if(n(q)&&n(p)&&g>=q&&g<=p){e=k;break a}}e=null}else for(k=0;k<f.length;++k)b.oa.push(f[k]);if(!e){f=D(d,M,1);e={};for(k=0;k<f.length;k++)e[A(f[k],4)]=!0;f=null;e[19]||e[8]?f=19:e[16]||e[1]?f=16:0<d.i().length&&0<A(d,3).length&&e[34]&&(f=34);null!=f?(e=new M,B(e,6,3),B(e,4,f),16!=f&&19!=f&&e.ma("pso-ama-fallback")):e=null}(f=!e)||(!n(g)||800>g?f=!1:820>g?(hc(a,["26835111"]),f=!0):(840>g&&hc(a,["26835112"]),f=!1));if(f)return mc(16);(g=e.fa())&&fc(a,g);g=!0;
A(c.N(),2)&&(Date.now?Date.now():+new Date)<A(c.N(),2)||(fc(a,"pso-ama-exd"),g=!1);A(b.m,11)&&(fc(a,"pso-ama-stl-tmp"),g=!1);g&&fc(a,"pso-ama-elig");2==A(e,6)&&(b=A(e,1),null!=b&&hc(a,[""+b]));if(g&&(2==A(e,6)||1==A(e,6))){d=D(d,M,1);if(null===c.ea)c=[];else{b={};c=[];for(g=0;g<d.length;g++)f=nc(d[g]),null==f||b[f]||(b[f]=!0,c.push(f));b=nc(e);if(null!=b){d=[];b=gc(b);g=!1;if(b)for(f=0;f<c.length;f++)k=gc(c[f]),b==k&&(g=!0),k&&d.push("950"+b+k);g||(d=[]);c=d}else c=[]}hc(a,c)}a=new Sb;a.Z=A(e,5);
a.J=A(e,4);return a},mc=function(a){var b=new Sb;b.J=a;return b},pc=function(a){a=a.google_ad_modifications=a.google_ad_modifications||{};a.remove_ads_by_default=!0;a.ad_whitelist=[{ad_tag_origin:"pso"}];a.ad_blacklist=[];a.space_collapsing="slot"},nc=function(a){var b;switch(A(a,6)){case 1:b=A(a,4);break;case 2:b=A(a,7)}return null!=b?b:null};var qc=function(a){this.document=a};var W=function(a){G.call(this,a)};r(W,G);W.prototype.getData=function(a){var b=W.La.getData.call(this,a),c;a:{c=(new qc(a.document)).document.getElementsByTagName("script");for(var d=0;d<c.length;++d)if(c[d].hasAttribute("data-pso-version")){c=c[d].getAttribute("data-pso-version");break a}c=null}b.sv=c;if(d=H(a).ps||null){c=d.m;var d=d.f(),e=b.wpc;b.wpc=null!=e?e:c.A();b.su=A(c,14);b.tn=c.O();b.ev=d&&A(d,5)}if(a=H(a).ss||null)b.s=a.J,b.st=a.Z;return b};var rc=null,sc=!1,vc=function(a){var b=tc,c=uc;b.addEventListener?(a&&b.addEventListener("DOMContentLoaded",a,!1),c&&b.addEventListener("load",c,!1)):b.attachEvent&&c&&b.attachEvent("onload",c)},xc=function(a){n(rc)&&a.clearInterval&&(a.clearInterval(rc),rc=null);sc||wc(a,!1);wc(a,!0)},yc=function(a,b){try{xc(b);var c=H(b).ss||null;if(c&&c.I){var d=c.I,e=d.B(),f=d.o,g=d.v,k=d.W,m=d.j.length;e||0!=m||f.push(6);for(var l=new W(m),c=0;c<g.length;c++)l.C(g[c]);if(e&&0==f.length&&null===k)bb(a,a.Ka,a.$,
l);else{for(e=0;e<f.length;e++)l.g(f[e]);cb(a,ab(l,k))}}else cb(a,(new W(0)).g(2))}catch(p){cb(a,ab((new W(0)).g(1),p))}H(b).loaded=!0},wc=function(a,b){b||(sc=!0);if((a=H(a).ss||null)&&a.I){a=a.I;try{a.apply(b)}catch(c){a.g(1),null===a.W&&(a.W=c)}}},zc=function(){wc(window,!1)};var X=new function(a){this.Ka="pso_success";this.za="pso_failure";this.V=this.$=.01;this.Ba=!1;this.K=a}(window);
try{var V=window,Qa,Ac=H(V).config;Qa=Ac?new O(Ac):null;if(!Qa)throw Error("No config");var Bc=Ra(10),Cc=Ra(7);X.$=null!=Bc?Bc:X.$;X.V=null!=Cc?Cc:X.V;var kc=new lb(Qa),Dc=kc;H(V).ps=Dc;var Y,lc;if(u("iPad")||u("Android")&&!u("Mobile")||u("Silk")||!(u("iPod")||u("iPhone")||u("Android")||u("IEMobile")))Y=mc(16);else{var Ec,Fc=/^#([^=]*)=(\d+)$/.exec(V.location.hash);if((Ec=Fc&&3==Fc.length&&"pso_strategy"==Fc[1]?+Fc[2]:null)&&U[Ec]){Y=mc(Ec);var Gc=V;jc(Ec)&&pc(Gc)}else{var Ic=V,Jc=kc.m.N(),Z;try{var Kc=
parseInt(Ic.localStorage.getItem("PSO_EXP0"),10);Z=isNaN(Kc)?null:Kc}catch(a){Z=null}if(null==Z){Z=Math.floor(1024*Math.random());var Lc=Z;try{Ic.localStorage.setItem("PSO_EXP0",Lc.toString())}catch(a){}}lc=new ic(Z,0,Jc);Y=oc()}if(1==Y.Z){var Mc=V;jc(Y.J)&&pc(Mc)}}if(!Y)throw Error("No strategyState created!");var Nc=Y;H(V).ss=Nc;var Oc=V,Pc=Y,Qc=Pc.J;if(n(Qc)){var Rc=U[Qc];Qc&&Rc&&(Pc.I=new Rc(Oc))}var tc=V,uc=ea(yc,X,tc),Sc=ea(xc,tc);switch(tc.document.readyState){case "complete":uc();break;case "interactive":Sc();
vc();break;default:var Tc=tc,Uc=ob(Tc);Uc.loaded||(Uc.onload=zc);rc=Tc.setInterval(zc,10);vc(Sc)}}catch(a){cb(X,ab(new W(0),a))};})();
</script><script type="text/javascript" async="" src="./Secure Spring REST API using OAuth2 - WebSystique_files/embed.js.download"></script><script id="facebook-jssdk" async="" src="./Secure Spring REST API using OAuth2 - WebSystique_files/all.js.download"></script><script async="" type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/count.js.download"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style><script type="text/javascript" src="chrome-extension://hdokiejnpimakedhajhdlcegeplioahd/xhrExtension.js"></script><script src="./Secure Spring REST API using OAuth2 - WebSystique_files/alfie.f51946af45e0b561c60f768335c9eb79.js.download" async="" charset="UTF-8"></script></head>

<body class="single single-post postid-2904 single-format-standard custom-background" data-gr-c-s-loaded="true">
<div id="page" class="hfeed site">

	<div id="top-bar">
		<nav id="site-navigation" class="main-navigation" role="navigation">
		<div id="topbar-search"><form role="search" method="get" class="search-form" action="http://websystique.com/">
	<button type="submit" class="search-submit"><i class="dashicons dashicons-search"></i></button>
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search and hit enter" value="" name="s" title="Search for:">
	</label>
</form></div>
			<h1 class="menu-toggle"><i class="dashicons dashicons-menu"></i></h1>
			<a class="skip-link screen-reader-text" href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/#content">Skip to content</a>
			<div class="menu-menu-1-container"><ul id="menu-menu-1" class="menu nav-menu"><li id="menu-item-424" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-424"><a href="http://websystique.com/">Home</a></li>
<li id="menu-item-1922" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1922"><a href="http://websystique.com/angularjs-tutorial/">Angularjs</a></li>
<li id="menu-item-564" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-564"><a href="http://websystique.com/spring-4-tutorial/">Spring 4</a></li>
<li id="menu-item-430" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-430"><a href="http://websystique.com/spring-4-mvc-tutorial/">Spring 4 MVC</a></li>
<li id="menu-item-1509" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1509"><a href="http://websystique.com/spring-security-tutorial/">Spring Security 4</a></li>
<li id="menu-item-429" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-429"><a href="http://websystique.com/spring-batch-tutorial/">Spring Batch</a></li>
<li id="menu-item-427" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-427"><a href="http://websystique.com/hibernate-4-tutorial/">Hibernate 4</a></li>
<li id="menu-item-1176" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1176"><a href="http://websystique.com/java/testng-tutorial/">TestNG</a></li>
<li id="menu-item-2047" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2047"><a href="http://websystique.com/divers/">Divers</a>
<ul class="sub-menu">
	<li id="menu-item-1066" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1066"><a href="http://websystique.com/java/json-tutorial/">JSON</a></li>
	<li id="menu-item-987" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-987"><a href="http://websystique.com/java/jaxb2-tutorial/">JAXB2</a></li>
	<li id="menu-item-426" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-426"><a href="http://websystique.com/maven-tutorial/">Maven</a></li>
</ul>
</li>
<li id="menu-item-965" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-965"><a href="http://websystique.com/contact-us/">Contact Us</a></li>
</ul></div>		</nav><!-- #site-navigation -->
		<div class="clear"></div>
	</div>
	
	<header id="masthead" class="site-header" role="banner">
		<div class="site-branding">
	<h1 class="site-title"><a href="http://websystique.com/" rel="home">WebSystique</a></h1>
	<h2 class="site-description">learn together</h2>
</div>
	</header><!-- #masthead -->


	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-2904" class="post-2904 post type-post status-publish format-standard hentry category-spring-security">
	<header class="entry-header">
		<h1 class="entry-title">Secure Spring REST API using OAuth2</h1>

		<div class="entry-meta">
			<span class="posted-on"><i class=""></i> <strong>Created on: </strong><time class="entry-date published" datetime="2016-07-30T20:52:53+00:00">July 30, 2016</time> | <strong>Last updated on: </strong><time class="updated" datetime="2016-11-14T23:26:18+00:00">November 14, 2016</time></span><span class="byline"> <i class="dashicons dashicons-admin-users"></i> <span class="author vcard"><a class="url fn n" href="http://websystique.com/author/blogadminuser/">websystiqueadmin</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>Let’s secure our <code>Spring REST API</code> using <code>OAuth2</code> this time, a simple guide showing what is required to secure a REST API using <code>Spring OAuth2</code>. Our use-case fits well with <code>Resource-owner Password Grant</code> flow of OAUth2 specification. We will use two different clients [Postman and a <code>Spring RestTemplate</code> based java application] to access our OAuth2 protected REST resources.</p>
<p>If you are already familiar with OAuth2 concepts, you may want to skip the theory, and jump right into code. As always, complete code can be found in attachment at the end of this article.</p>
<hr>
<div class="remarks">
<strong>Other interesting posts you may like</strong><br><p></p>
<ul>
<li><a href="http://websystique.com/spring-security/angularjs-basic-authentication-using-spring-security/">AngularJS+Spring Security using Basic Authentication</a></li>
<li><a href="http://websystique.com/spring-security/secure-spring-rest-api-using-basic-authentication/">Secure Spring REST API using Basic Authentication</a></li>
</ul>
</div>
<h3>What is OAuth2</h3>
<p>OAuth2 is an standardized authorization protocol/framework. As per Official <a href="https://tools.ietf.org/html/rfc6749" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://tools.ietf.org/html/rfc6749&#39;, &#39;OAuth2 Specification&#39;]);">OAuth2 Specification</a>: </p>
<blockquote><div class="googlepublisherpluginad" style="text-align: center; width: 100%; height: auto; clear: none;"><ins data-ad-format="auto" class="adsbygoogle" data-ad-client="ca-pub-6696898840465221" data-tag-origin="pso" data-ad-slot="7269583195" data-ad-channel="WordPressSinglePost" data-adsbygoogle-status="reserved" style="display: block; margin: 10px auto 18px; background-color: transparent;"></ins></div><p>The OAuth 2.0 authorization framework enables a third-party application to obtain <u>limited access</u> to an HTTP service, either on behalf of a resource owner by orchestrating an approval interaction between the resource owner and the HTTP service, or by allowing the third-party application to obtain access on its own behalf.</p></blockquote>
<p>Big players like Google, Facebook and others are already using their own OAuth2 implementations for quite some time. Enterprises too are moving fast towards OAuth2 adoption. </p>
<p>I found OAuth2 specification rather simple to follow. Yet if you want to start even quickly, an excellent article on OAuth2 fundamentals can be found <a href="http://www.bubblecode.net/en/2016/01/22/understanding-oauth2/" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;http://www.bubblecode.net/en/2016/01/22/understanding-oauth2/&#39;, &#39;here&#39;]);">here</a> which gives a deep insight in OAUth2 theoretical concepts. </p>
<p><a href="http://projects.spring.io/spring-security-oauth/" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;http://projects.spring.io/spring-security-oauth/&#39;, &#39;Spring Security OAuth&#39;]);">Spring Security OAuth</a> project provides all the necessary API we might need in order to develop an OAuth2 compliant implementation using Spring. Official <a href="https://github.com/spring-projects/spring-security-oauth/tree/master/samples/oauth2" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://github.com/spring-projects/spring-security-oauth/tree/master/samples/oauth2&#39;, &#39;Spring security oauth&#39;]);">Spring security oauth</a> project provides a comprehensive example for implementing OAuth2. The code samples of this post is inspired by that examples itself. The intention of this post is to just use bare-minimum functionality required in order to secure our REST API, nothing more. </p>
<p>At minimum, you should be aware of four key concepts in OAuth2:</p>
<h3>1. OAuth2 Roles</h3>
<p>OAuth2 defines four roles:</p>
<ul>
<li>
<strong><code>resource owner</code>:</strong><br>
Could be you. An entity capable of granting access to a protected resource. When the resource owner is a person, it is referred to as an end-user.
</li>
<li>
<strong><code>resource server</code>:</strong><br>
The server hosting the protected resources, capable of accepting and responding to protected resource requests using access tokens.
</li>
<li>
<strong><code>client</code>:</strong><br>
An application making protected resource requests on behalf of the resource owner and with its authorization. It could be a mobile app asking your permission to access your Facebook feeds, a REST client trying to access REST API, a web site [Stackoverflow e.g.] providing an alternative login option using Facebook account.
</li>
<li>
<strong><code>authorization server</code>:</strong><br>
The server issuing access tokens to the client after successfully authenticating the resource owner and obtaining authorization.
</li>
</ul>
<p>In our example, our REST API can only be accessed via Resource server which will require an access token to be present with request</p>
<h3>2. OAuth2 Authorization Grant types</h3>
<p>An authorization grant is a credential representing the resource owner’s authorization (to access its protected resources) used by the client to obtain an access token.  The specification defines four grant types:</p>
<ul>
<li><code>authorization code</code></li>
<li><code>implicit</code></li>
<li><code>resource owner password credentials</code></li>
<li><code>client credentials</code></li>
</ul>
<p>We will be using <code>resource owner password credentials</code> grant type. The reason is simple, we are not implementing a view which redirects us to a login page. Only the usage where a client [Postman or RestTemplate based Java client e.g.] have the Resource owner’s credentials and they provide those credential [along with client credentials] to authorization server in order to eventually receive the access-token[and optionally refresh token], and then use that token to actually access the resources. </p>
<p>A common example is the <code>GMail app</code> [a client] on your smartphone which takes your credentials and use them to connect to <code>GMail servers</code>. It also shows that ‘Password Credentials Grant’ is best suited when both the client and the servers are from same company as the trust is there, you don’t want to provide your credentials to a third party.</p>
<h3>3. OAuth2 Tokens</h3>
<p>Tokens are implementation specific random strings, generated by the authorization server and are issued when the client requests them.</p>
<ul>
<li><code>Access Token</code> : Sent with each request, usually valid for a very short life time [an hour e.g.]</li>
<li><code>Refresh Token</code> : Mainly used to get a new access token, not sent with each request, usually lives longer than access token.</li>
</ul>
<div class="remarks">
<strong>A Word on HTTPS</strong> : For any sort of Security implementation, ranging from Basic authentication to a full fledged OAuth2 implementation, <strong><code>HTTPS</code></strong> is a must have. Without HTTPS, no matter what your implementation is, security is vulnerable to be compromised.
</div>
<h3>4. OAuth2 Access Token Scope </h3>
<p>Client can ask for the resource with specific access rights using scope [want to access feeds &amp; photos of this users facebook account], and authorization server in turn return scope showing what access rights were actually granted to the client [Resource owner only allowed feeds access, no photos e.g.]. </p>
<hr>
<h1>Let’s Get into Code</h1>
<p>Let’s implement the necessary building blocks to implement OAuth using Spring Security, in order to access our REST resources.</p>
<h3>1. Resource Server</h3>
<p>Resource Server hosts the resources [our REST API] the client is interested in. Resources are located on <code>/user/</code>. <code>@EnableResourceServer</code> annotation, applied on OAuth2 Resource Servers, enables a Spring Security filter that authenticates requests using an incoming OAuth2 token. Class <code>ResourceServerConfigurerAdapter</code> implements <code>ResourceServerConfigurer</code> providing methods to adjust the access rules and paths that are protected by OAuth2 security.</p>
<div><div id="highlighter_667284" class="syntaxhighlighter nogutter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">com.websystique.springmvc.security;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.context.annotation.Configuration;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.web.builders.HttpSecurity;</code></div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configurers.ResourceServerSecurityConfigurer;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.error.OAuth2AccessDeniedHandler;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="java color1">@Configuration</code></div><div class="line number11 index10 alt2"><code class="java color1">@EnableResourceServer</code></div><div class="line number12 index11 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">ResourceServerConfiguration </code><code class="java keyword">extends</code> <code class="java plain">ResourceServerConfigurerAdapter {</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">final</code> <code class="java plain">String RESOURCE_ID = </code><code class="java string">"my_rest_api"</code><code class="java plain">;</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">configure(ResourceServerSecurityConfigurer resources) {</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">resources.resourceId(RESOURCE_ID).stateless(</code><code class="java keyword">false</code><code class="java plain">);</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">configure(HttpSecurity http) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">http.</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">anonymous().disable()</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.requestMatchers().antMatchers(</code><code class="java string">"/user/**"</code><code class="java plain">)</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.and().authorizeRequests()</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.antMatchers(</code><code class="java string">"/user/**"</code><code class="java plain">).access(</code><code class="java string">"hasRole('ADMIN')"</code><code class="java plain">)</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.and().exceptionHandling().accessDeniedHandler(</code><code class="java keyword">new</code> <code class="java plain">OAuth2AccessDeniedHandler());</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<h3>2. Authorization Server</h3>
<p>Authorization server is the one responsible for verifying credentials and if credentials are OK, providing the tokens[refresh-token as well as access-token]. It also contains information about registered clients and possible access scopes and grant types. The token store is used to store the token. We will be using an in-memory token store.<code>@EnableAuthorizationServer</code> enables an Authorization Server (i.e. an AuthorizationEndpoint and a TokenEndpoint) in the current application context. Class <code>AuthorizationServerConfigurerAdapter</code> implements <code>AuthorizationServerConfigurer</code> which provides all the necessary methods to configure an Authorization server.</p>
<div><div id="highlighter_693250" class="syntaxhighlighter nogutter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">com.websystique.springmvc.security;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.beans.factory.annotation.Autowired;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.beans.factory.annotation.Qualifier;</code></div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.context.annotation.Configuration;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.authentication.AuthenticationManager;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;</code></div><div class="line number10 index9 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;</code></div><div class="line number11 index10 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer;</code></div><div class="line number12 index11 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.approval.UserApprovalHandler;</code></div><div class="line number13 index12 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.token.TokenStore;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="java color1">@Configuration</code></div><div class="line number16 index15 alt1"><code class="java color1">@EnableAuthorizationServer</code></div><div class="line number17 index16 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">AuthorizationServerConfiguration </code><code class="java keyword">extends</code> <code class="java plain">AuthorizationServerConfigurerAdapter {</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java plain">String REALM=</code><code class="java string">"MY_OAUTH_REALM"</code><code class="java plain">;</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">TokenStore tokenStore;</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">UserApprovalHandler userApprovalHandler;</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Qualifier</code><code class="java plain">(</code><code class="java string">"authenticationManagerBean"</code><code class="java plain">)</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">AuthenticationManager authenticationManager;</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">configure(ClientDetailsServiceConfigurer clients) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">clients.inMemory()</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.withClient(</code><code class="java string">"my-trusted-client"</code><code class="java plain">)</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.authorizedGrantTypes(</code><code class="java string">"password"</code><code class="java plain">, </code><code class="java string">"authorization_code"</code><code class="java plain">, </code><code class="java string">"refresh_token"</code><code class="java plain">, </code><code class="java string">"implicit"</code><code class="java plain">)</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.authorities(</code><code class="java string">"ROLE_CLIENT"</code><code class="java plain">, </code><code class="java string">"ROLE_TRUSTED_CLIENT"</code><code class="java plain">)</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.scopes(</code><code class="java string">"read"</code><code class="java plain">, </code><code class="java string">"write"</code><code class="java plain">, </code><code class="java string">"trust"</code><code class="java plain">)</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.secret(</code><code class="java string">"secret"</code><code class="java plain">)</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.accessTokenValiditySeconds(</code><code class="java value">120</code><code class="java plain">).</code><code class="java comments">//Access token is only valid for 2 minutes.</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">refreshTokenValiditySeconds(</code><code class="java value">600</code><code class="java plain">);</code><code class="java comments">//Refresh token is only valid for 10 minutes.</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">configure(AuthorizationServerEndpointsConfigurer endpoints) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">endpoints.tokenStore(tokenStore).userApprovalHandler(userApprovalHandler)</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.authenticationManager(authenticationManager);</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">configure(AuthorizationServerSecurityConfigurer oauthServer) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">oauthServer.realm(REALM+</code><code class="java string">"/client"</code><code class="java plain">);</code></div><div class="line number53 index52 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Above configuration </p>
<ul>
<li>Registers a client with client-id ‘my-trusted-client’ and password ‘secret’ and roles &amp; scope he is allowed for.</li>
<li>Specifies that any generated access token will be valid for only 120 seconds</li>
<li>Specifies that any generated refresh token will be valid for only 600 seconds</li>
</ul>
<h3>3. Security Configuration</h3>
<p>Gluing everything together. Endpoint <code>/oauth/token</code> is used to request a token [access or refresh]. Resource owners [bill,bob] are configured here itself.</p>
<div><div id="highlighter_437987" class="syntaxhighlighter nogutter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">com.websystique.springmvc.security;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.beans.factory.annotation.Autowired;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.context.annotation.Bean;</code></div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.context.annotation.Configuration;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.authentication.AuthenticationManager;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.web.builders.HttpSecurity;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;</code></div><div class="line number10 index9 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</code></div><div class="line number11 index10 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.ClientDetailsService;</code></div><div class="line number12 index11 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.approval.ApprovalStore;</code></div><div class="line number13 index12 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.approval.TokenApprovalStore;</code></div><div class="line number14 index13 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.approval.TokenStoreUserApprovalHandler;</code></div><div class="line number15 index14 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.request.DefaultOAuth2RequestFactory;</code></div><div class="line number16 index15 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.token.TokenStore;</code></div><div class="line number17 index16 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.token.store.InMemoryTokenStore;</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java color1">@Configuration</code></div><div class="line number20 index19 alt1"><code class="java color1">@EnableWebSecurity</code></div><div class="line number21 index20 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">OAuth2SecurityConfiguration </code><code class="java keyword">extends</code> <code class="java plain">WebSecurityConfigurerAdapter {</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">ClientDetailsService clientDetailsService;</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">globalUserDetails(AuthenticationManagerBuilder auth) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">auth.inMemoryAuthentication()</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.withUser(</code><code class="java string">"bill"</code><code class="java plain">).password(</code><code class="java string">"abc123"</code><code class="java plain">).roles(</code><code class="java string">"ADMIN"</code><code class="java plain">).and()</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.withUser(</code><code class="java string">"bob"</code><code class="java plain">).password(</code><code class="java string">"abc123"</code><code class="java plain">).roles(</code><code class="java string">"USER"</code><code class="java plain">);</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code> <code class="java keyword">void</code> <code class="java plain">configure(HttpSecurity http) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">http</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.csrf().disable()</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.anonymous().disable()</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.authorizeRequests()</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.antMatchers(</code><code class="java string">"/oauth/token"</code><code class="java plain">).permitAll();</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Bean</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">AuthenticationManager authenticationManagerBean() </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">super</code><code class="java plain">.authenticationManagerBean();</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Bean</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">TokenStore tokenStore() {</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">InMemoryTokenStore();</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number53 index52 alt2">&nbsp;</div><div class="line number54 index53 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Bean</code></div><div class="line number55 index54 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number56 index55 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">TokenStoreUserApprovalHandler userApprovalHandler(TokenStore tokenStore){</code></div><div class="line number57 index56 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">TokenStoreUserApprovalHandler handler = </code><code class="java keyword">new</code> <code class="java plain">TokenStoreUserApprovalHandler();</code></div><div class="line number58 index57 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">handler.setTokenStore(tokenStore);</code></div><div class="line number59 index58 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">handler.setRequestFactory(</code><code class="java keyword">new</code> <code class="java plain">DefaultOAuth2RequestFactory(clientDetailsService));</code></div><div class="line number60 index59 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">handler.setClientDetailsService(clientDetailsService);</code></div><div class="line number61 index60 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">handler;</code></div><div class="line number62 index61 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number63 index62 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number64 index63 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Bean</code></div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ApprovalStore approvalStore(TokenStore tokenStore) </code><code class="java keyword">throws</code> <code class="java plain">Exception {</code></div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">TokenApprovalStore store = </code><code class="java keyword">new</code> <code class="java plain">TokenApprovalStore();</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">store.setTokenStore(tokenStore);</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">store;</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number71 index70 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number72 index71 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Additionally, enable Global method security which will activate @PreFilter, @PostFilter, @PreAuthorize @PostAuthorize annotations if we want to use them.</p>
<div><div id="highlighter_370566" class="syntaxhighlighter nogutter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">com.websystique.springmvc.security;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.beans.factory.annotation.Autowired;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.context.annotation.Configuration;</code></div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="java color1">@Configuration</code></div><div class="line number11 index10 alt2"><code class="java color1">@EnableGlobalMethodSecurity</code><code class="java plain">(prePostEnabled = </code><code class="java keyword">true</code><code class="java plain">, proxyTargetClass = </code><code class="java keyword">true</code><code class="java plain">)</code></div><div class="line number12 index11 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">MethodSecurityConfig </code><code class="java keyword">extends</code> <code class="java plain">GlobalMethodSecurityConfiguration {</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java plain">OAuth2SecurityConfiguration securityConfig;</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code> <code class="java plain">MethodSecurityExpressionHandler createExpressionHandler() {</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">OAuth2MethodSecurityExpressionHandler();</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number20 index19 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<h3>4. Endpoints and their purpose</h3>
<ul>
<li>
Attempt to access resources [REST API] without any authorization [will fail of-course].<br>
<code>GET  http://localhost:8080/SpringSecurityOAuth2Example/user/</code>
</li>
<li>
Ask for tokens[access+refresh] using <strong>HTTP POST</strong> on <code>/oauth/token</code>, with grant_type=password,and resource owners credentials as req-params. Additionally, send client credentials in Authorization header.<p></p>
<p><code>POST http://localhost:8080/SpringSecurityOAuth2Example/oauth/token?grant_type=password&amp;username=bill&amp;password=abc123</code></p>
</li>
<li>
Ask for a new access token via valid refresh-token, using <strong>HTTP POST</strong> on <code>/oauth/token</code>, with grant_type=refresh_token,and sending actual refresh token. Additionally, send client credentials in Authorization header.<p></p>
<p><code>POST http://localhost:8080/SpringSecurityOAuth2Example/oauth/token?grant_type=refresh_token&amp;refresh_token=094b7d23-973f-4cc1-83ad-8ffd43de1845</code>
</p></li>
<li>
Access the resource by providing an access token using <code>access_token</code> query param with request.<br>
<code>GET http://localhost:8080/SpringSecurityOAuth2Example/user/?access_token=3525d0e4-d881-49e7-9f91-bcfd18259109</code>
</li>
</ul>
<h3>5. Rest API</h3>
<p>The simple Spring REST API i used in most of my posts.</p>
<div><div id="highlighter_151004" class="syntaxhighlighter nogutter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">com.websystique.springmvc.controller;</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">java.util.List;</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.beans.factory.annotation.Autowired;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.HttpHeaders;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.HttpStatus;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.MediaType;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.ResponseEntity;</code></div><div class="line number10 index9 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.bind.annotation.PathVariable;</code></div><div class="line number11 index10 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.bind.annotation.RequestBody;</code></div><div class="line number12 index11 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.bind.annotation.RequestMapping;</code></div><div class="line number13 index12 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.bind.annotation.RequestMethod;</code></div><div class="line number14 index13 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.bind.annotation.RestController;</code></div><div class="line number15 index14 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.util.UriComponentsBuilder;</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number17 index16 alt2"><code class="java keyword">import</code> <code class="java plain">com.websystique.springmvc.model.User;</code></div><div class="line number18 index17 alt1"><code class="java keyword">import</code> <code class="java plain">com.websystique.springmvc.service.UserService;</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="java color1">@RestController</code></div><div class="line number21 index20 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">HelloWorldRestController {</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Autowired</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">UserService userService;&nbsp; </code><code class="java comments">//Service which will do all data retrieval/manipulation work</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//-------------------Retrieve All Users--------------------------------------------------------</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@RequestMapping</code><code class="java plain">(value = </code><code class="java string">"/user/"</code><code class="java plain">, method = RequestMethod.GET)</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ResponseEntity&lt;List&lt;User&gt;&gt; listAllUsers() {</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">List&lt;User&gt; users = userService.findAllUsers();</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code><code class="java plain">(users.isEmpty()){</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;List&lt;User&gt;&gt;(HttpStatus.NO_CONTENT);</code><code class="java comments">//You many decide to return HttpStatus.NOT_FOUND</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;List&lt;User&gt;&gt;(users, HttpStatus.OK);</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//-------------------Retrieve Single User--------------------------------------------------------</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@RequestMapping</code><code class="java plain">(value = </code><code class="java string">"/user/{id}"</code><code class="java plain">, method = RequestMethod.GET, produces = {MediaType.APPLICATION_JSON_VALUE,MediaType.APPLICATION_XML_VALUE})</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ResponseEntity&lt;User&gt; getUser(</code><code class="java color1">@PathVariable</code><code class="java plain">(</code><code class="java string">"id"</code><code class="java plain">) </code><code class="java keyword">long</code> <code class="java plain">id) {</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Fetching User with id "</code> <code class="java plain">+ id);</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">User user = userService.findById(id);</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(user == </code><code class="java keyword">null</code><code class="java plain">) {</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"User with id "</code> <code class="java plain">+ id + </code><code class="java string">" not found"</code><code class="java plain">);</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(HttpStatus.NOT_FOUND);</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(user, HttpStatus.OK);</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number53 index52 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number54 index53 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//-------------------Create a User--------------------------------------------------------</code></div><div class="line number55 index54 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number56 index55 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@RequestMapping</code><code class="java plain">(value = </code><code class="java string">"/user/"</code><code class="java plain">, method = RequestMethod.POST)</code></div><div class="line number57 index56 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ResponseEntity&lt;Void&gt; createUser(</code><code class="java color1">@RequestBody</code> <code class="java plain">User user, UriComponentsBuilder ucBuilder) {</code></div><div class="line number58 index57 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Creating User "</code> <code class="java plain">+ user.getName());</code></div><div class="line number59 index58 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number60 index59 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(userService.isUserExist(user)) {</code></div><div class="line number61 index60 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"A User with name "</code> <code class="java plain">+ user.getName() + </code><code class="java string">" already exist"</code><code class="java plain">);</code></div><div class="line number62 index61 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;Void&gt;(HttpStatus.CONFLICT);</code></div><div class="line number63 index62 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number64 index63 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">userService.saveUser(user);</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpHeaders headers = </code><code class="java keyword">new</code> <code class="java plain">HttpHeaders();</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">headers.setLocation(ucBuilder.path(</code><code class="java string">"/user/{id}"</code><code class="java plain">).buildAndExpand(user.getId()).toUri());</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;Void&gt;(headers, HttpStatus.CREATED);</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number71 index70 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number72 index71 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number73 index72 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//------------------- Update a User --------------------------------------------------------</code></div><div class="line number74 index73 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number75 index74 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@RequestMapping</code><code class="java plain">(value = </code><code class="java string">"/user/{id}"</code><code class="java plain">, method = RequestMethod.PUT)</code></div><div class="line number76 index75 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ResponseEntity&lt;User&gt; updateUser(</code><code class="java color1">@PathVariable</code><code class="java plain">(</code><code class="java string">"id"</code><code class="java plain">) </code><code class="java keyword">long</code> <code class="java plain">id, </code><code class="java color1">@RequestBody</code> <code class="java plain">User user) {</code></div><div class="line number77 index76 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Updating User "</code> <code class="java plain">+ id);</code></div><div class="line number78 index77 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number79 index78 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">User currentUser = userService.findById(id);</code></div><div class="line number80 index79 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number81 index80 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(currentUser==</code><code class="java keyword">null</code><code class="java plain">) {</code></div><div class="line number82 index81 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"User with id "</code> <code class="java plain">+ id + </code><code class="java string">" not found"</code><code class="java plain">);</code></div><div class="line number83 index82 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(HttpStatus.NOT_FOUND);</code></div><div class="line number84 index83 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number85 index84 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number86 index85 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">currentUser.setName(user.getName());</code></div><div class="line number87 index86 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">currentUser.setAge(user.getAge());</code></div><div class="line number88 index87 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">currentUser.setSalary(user.getSalary());</code></div><div class="line number89 index88 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number90 index89 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">userService.updateUser(currentUser);</code></div><div class="line number91 index90 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(currentUser, HttpStatus.OK);</code></div><div class="line number92 index91 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number93 index92 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number94 index93 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//------------------- Delete a User --------------------------------------------------------</code></div><div class="line number95 index94 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number96 index95 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@RequestMapping</code><code class="java plain">(value = </code><code class="java string">"/user/{id}"</code><code class="java plain">, method = RequestMethod.DELETE)</code></div><div class="line number97 index96 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ResponseEntity&lt;User&gt; deleteUser(</code><code class="java color1">@PathVariable</code><code class="java plain">(</code><code class="java string">"id"</code><code class="java plain">) </code><code class="java keyword">long</code> <code class="java plain">id) {</code></div><div class="line number98 index97 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Fetching &amp; Deleting User with id "</code> <code class="java plain">+ id);</code></div><div class="line number99 index98 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number100 index99 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">User user = userService.findById(id);</code></div><div class="line number101 index100 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code> <code class="java plain">(user == </code><code class="java keyword">null</code><code class="java plain">) {</code></div><div class="line number102 index101 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Unable to delete. User with id "</code> <code class="java plain">+ id + </code><code class="java string">" not found"</code><code class="java plain">);</code></div><div class="line number103 index102 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(HttpStatus.NOT_FOUND);</code></div><div class="line number104 index103 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number105 index104 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number106 index105 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">userService.deleteUserById(id);</code></div><div class="line number107 index106 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(HttpStatus.NO_CONTENT);</code></div><div class="line number108 index107 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number109 index108 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number110 index109 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number111 index110 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//------------------- Delete All Users --------------------------------------------------------</code></div><div class="line number112 index111 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number113 index112 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@RequestMapping</code><code class="java plain">(value = </code><code class="java string">"/user/"</code><code class="java plain">, method = RequestMethod.DELETE)</code></div><div class="line number114 index113 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java plain">ResponseEntity&lt;User&gt; deleteAllUsers() {</code></div><div class="line number115 index114 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Deleting All Users"</code><code class="java plain">);</code></div><div class="line number116 index115 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number117 index116 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">userService.deleteAllUsers();</code></div><div class="line number118 index117 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java keyword">new</code> <code class="java plain">ResponseEntity&lt;User&gt;(HttpStatus.NO_CONTENT);</code></div><div class="line number119 index118 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number120 index119 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number121 index120 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<h3>6. Running the application</h3>
<p>Run it and test it using two different clients.</p>
<h4>Client 1: Postman</h4>
<p>Try to access a resource without any auth info, wil get a 401.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img1.png" alt="SpringOAuth2_img1" width="1178" height="568" class="aligncenter size-full wp-image-2905"></p>
<p>Let’s get the tokens. First add an authorization header with <strong>client credentials</strong> [my-trusted-client/secret].</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img2.png" alt="SpringOAuth2_img2" width="1178" height="569" class="aligncenter size-full wp-image-2906"></p>
<p>Click on update request, verify the header in header-tab.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img3.png" alt="SpringOAuth2_img3" width="1178" height="568" class="aligncenter size-full wp-image-2907"></p>
<p>Send the Post request, you should receive the response containing <code>access-token</code> as well as <code>refresh-token</code>.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img4.png" alt="SpringOAuth2_img4" width="1178" height="624" class="aligncenter size-full wp-image-2908"></p>
<p>Save these tokens somewhere, you will need them. Now you can use this access-token [valid for 2 minutes] to access resources.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img5.png" alt="SpringOAuth2_img5" width="1175" height="651" class="aligncenter size-full wp-image-2909"></p>
<p>After 2 minutes, access-token gets expired, your further resource requests will fail.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img6.png" alt="SpringOAuth2_img6" width="1177" height="501" class="aligncenter size-full wp-image-2910"></p>
<p>We need a new access-token. Fire a post to with refresh-token to get a brand-new access-token.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img7.png" alt="SpringOAuth2_img7" width="1177" height="603" class="aligncenter size-full wp-image-2911"></p>
<p>Use this new access-token to access the resources.</p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img8.png" alt="SpringOAuth2_img8" width="1179" height="604" class="aligncenter size-full wp-image-2912"></p>
<p>Refresh-token expires too[10 minutes]. After that, you should see your refresh request getting failed. </p>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img9.png" alt="SpringOAuth2_img9" width="1178" height="602" class="aligncenter size-full wp-image-2913"></p>
<p>It means you need to request a new refresh+access-token, as in step 2.</p>
<h4>Client 2: RestTemplate based java application</h4>
<p>Method <strong>sendTokenRequest</strong> is used to actually get the tokens. The access-token we got in response is then used with each request. If required, You can implement the refresh-token flow easily in below example.</p>
<div><div id="highlighter_553225" class="syntaxhighlighter nogutter  java"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">com.websystique.springmvc;</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code> <code class="java plain">java.net.URI;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code> <code class="java plain">java.util.Arrays;</code></div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">java.util.LinkedHashMap;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code> <code class="java plain">java.util.List;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java keyword">import</code> <code class="java plain">org.apache.commons.codec.binary.Base64;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.HttpEntity;</code></div><div class="line number10 index9 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.HttpHeaders;</code></div><div class="line number11 index10 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.HttpMethod;</code></div><div class="line number12 index11 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.MediaType;</code></div><div class="line number13 index12 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.http.ResponseEntity;</code></div><div class="line number14 index13 alt1"><code class="java keyword">import</code> <code class="java plain">org.springframework.util.Assert;</code></div><div class="line number15 index14 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.web.client.RestTemplate;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java keyword">import</code> <code class="java plain">com.websystique.springmvc.model.AuthTokenInfo;</code></div><div class="line number18 index17 alt1"><code class="java keyword">import</code> <code class="java plain">com.websystique.springmvc.model.User;</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">SpringRestClient {</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">final</code> <code class="java plain">String REST_SERVICE_URI = </code><code class="java string">"<a href="http://localhost:8080/SpringSecurityOAuth2Example">http://localhost:8080/SpringSecurityOAuth2Example</a>"</code><code class="java plain">;</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">final</code> <code class="java plain">String AUTH_SERVER_URI = </code><code class="java string">"<a href="http://localhost:8080/SpringSecurityOAuth2Example/oauth/token">http://localhost:8080/SpringSecurityOAuth2Example/oauth/token</a>"</code><code class="java plain">;</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">final</code> <code class="java plain">String QPM_PASSWORD_GRANT = </code><code class="java string">"?grant_type=password&amp;username=bill&amp;password=abc123"</code><code class="java plain">;</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">final</code> <code class="java plain">String QPM_ACCESS_TOKEN = </code><code class="java string">"?access_token="</code><code class="java plain">;</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Prepare HTTP Headers.</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java plain">HttpHeaders getHeaders(){</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpHeaders headers = </code><code class="java keyword">new</code> <code class="java plain">HttpHeaders();</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">headers.setAccept(Arrays.asList(MediaType.APPLICATION_JSON));</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">headers;</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Add HTTP Authorization header, using Basic-Authentication to send client-credentials.</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java plain">HttpHeaders getHeadersWithClientCredentials(){</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String plainClientCredentials=</code><code class="java string">"my-trusted-client:secret"</code><code class="java plain">;</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String base64ClientCredentials = </code><code class="java keyword">new</code> <code class="java plain">String(Base64.encodeBase64(plainClientCredentials.getBytes()));</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpHeaders headers = getHeaders();</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">headers.add(</code><code class="java string">"Authorization"</code><code class="java plain">, </code><code class="java string">"Basic "</code> <code class="java plain">+ base64ClientCredentials);</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">headers;</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;&nbsp;&nbsp; </code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a POST request [on /oauth/token] to get an access-token, which will then be send with each request.</code></div><div class="line number53 index52 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number54 index53 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@SuppressWarnings</code><code class="java plain">({ </code><code class="java string">"unchecked"</code><code class="java plain">})</code></div><div class="line number55 index54 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java plain">AuthTokenInfo sendTokenRequest(){</code></div><div class="line number56 index55 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate(); </code></div><div class="line number57 index56 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number58 index57 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;String&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;String&gt;(getHeadersWithClientCredentials());</code></div><div class="line number59 index58 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ResponseEntity&lt;Object&gt; response = restTemplate.exchange(AUTH_SERVER_URI+QPM_PASSWORD_GRANT, HttpMethod.POST, request, Object.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number60 index59 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">LinkedHashMap&lt;String, Object&gt; map = (LinkedHashMap&lt;String, Object&gt;)response.getBody();</code></div><div class="line number61 index60 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">AuthTokenInfo tokenInfo = </code><code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number62 index61 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number63 index62 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code><code class="java plain">(map!=</code><code class="java keyword">null</code><code class="java plain">){</code></div><div class="line number64 index63 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">tokenInfo = </code><code class="java keyword">new</code> <code class="java plain">AuthTokenInfo();</code></div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">tokenInfo.setAccess_token((String)map.get(</code><code class="java string">"access_token"</code><code class="java plain">));</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">tokenInfo.setToken_type((String)map.get(</code><code class="java string">"token_type"</code><code class="java plain">));</code></div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">tokenInfo.setRefresh_token((String)map.get(</code><code class="java string">"refresh_token"</code><code class="java plain">));</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">tokenInfo.setExpires_in((</code><code class="java keyword">int</code><code class="java plain">)map.get(</code><code class="java string">"expires_in"</code><code class="java plain">));</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">tokenInfo.setScope((String)map.get(</code><code class="java string">"scope"</code><code class="java plain">));</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(tokenInfo);</code></div><div class="line number71 index70 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//System.out.println("access_token ="+map.get("access_token")+", token_type="+map.get("token_type")+", refresh_token="+map.get("refresh_token")</code></div><div class="line number72 index71 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//+", expires_in="+map.get("expires_in")+", scope="+map.get("scope"));;</code></div><div class="line number73 index72 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code><code class="java keyword">else</code><code class="java plain">{</code></div><div class="line number74 index73 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"No user exist----------"</code><code class="java plain">);</code></div><div class="line number75 index74 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number76 index75 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number77 index76 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code> <code class="java plain">tokenInfo;</code></div><div class="line number78 index77 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number79 index78 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number80 index79 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number81 index80 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a GET request to get list of all users.</code></div><div class="line number82 index81 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number83 index82 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@SuppressWarnings</code><code class="java plain">({ </code><code class="java string">"unchecked"</code><code class="java plain">, </code><code class="java string">"rawtypes"</code> <code class="java plain">})</code></div><div class="line number84 index83 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">listAllUsers(AuthTokenInfo tokenInfo){</code></div><div class="line number85 index84 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Assert.notNull(tokenInfo, </code><code class="java string">"Authenticate first please......"</code><code class="java plain">);</code></div><div class="line number86 index85 alt1">&nbsp;</div><div class="line number87 index86 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"\nTesting listAllUsers API-----------"</code><code class="java plain">);</code></div><div class="line number88 index87 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate(); </code></div><div class="line number89 index88 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number90 index89 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;String&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;String&gt;(getHeaders());</code></div><div class="line number91 index90 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ResponseEntity&lt;List&gt; response = restTemplate.exchange(REST_SERVICE_URI+</code><code class="java string">"/user/"</code><code class="java plain">+QPM_ACCESS_TOKEN+tokenInfo.getAccess_token(),</code></div><div class="line number92 index91 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpMethod.GET, request, List.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number93 index92 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">List&lt;LinkedHashMap&lt;String, Object&gt;&gt; usersMap = (List&lt;LinkedHashMap&lt;String, Object&gt;&gt;)response.getBody();</code></div><div class="line number94 index93 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number95 index94 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code><code class="java plain">(usersMap!=</code><code class="java keyword">null</code><code class="java plain">){</code></div><div class="line number96 index95 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code><code class="java plain">(LinkedHashMap&lt;String, Object&gt; map : usersMap){</code></div><div class="line number97 index96 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"User : id="</code><code class="java plain">+map.get(</code><code class="java string">"id"</code><code class="java plain">)+</code><code class="java string">", Name="</code><code class="java plain">+map.get(</code><code class="java string">"name"</code><code class="java plain">)+</code><code class="java string">", Age="</code><code class="java plain">+map.get(</code><code class="java string">"age"</code><code class="java plain">)+</code><code class="java string">", Salary="</code><code class="java plain">+map.get(</code><code class="java string">"salary"</code><code class="java plain">));;</code></div><div class="line number98 index97 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number99 index98 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code><code class="java keyword">else</code><code class="java plain">{</code></div><div class="line number100 index99 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"No user exist----------"</code><code class="java plain">);</code></div><div class="line number101 index100 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number102 index101 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number103 index102 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number104 index103 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number105 index104 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a GET request to get a specific user.</code></div><div class="line number106 index105 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number107 index106 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">getUser(AuthTokenInfo tokenInfo){</code></div><div class="line number108 index107 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Assert.notNull(tokenInfo, </code><code class="java string">"Authenticate first please......"</code><code class="java plain">);</code></div><div class="line number109 index108 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"\nTesting getUser API----------"</code><code class="java plain">);</code></div><div class="line number110 index109 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate();</code></div><div class="line number111 index110 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;String&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;String&gt;(getHeaders());</code></div><div class="line number112 index111 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ResponseEntity&lt;User&gt; response = restTemplate.exchange(REST_SERVICE_URI+</code><code class="java string">"/user/1"</code><code class="java plain">+QPM_ACCESS_TOKEN+tokenInfo.getAccess_token(),</code></div><div class="line number113 index112 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpMethod.GET, request, User.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number114 index113 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">User user = response.getBody();</code></div><div class="line number115 index114 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(user);</code></div><div class="line number116 index115 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number117 index116 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number118 index117 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number119 index118 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a POST request to create a new user.</code></div><div class="line number120 index119 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number121 index120 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">createUser(AuthTokenInfo tokenInfo) {</code></div><div class="line number122 index121 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Assert.notNull(tokenInfo, </code><code class="java string">"Authenticate first please......"</code><code class="java plain">);</code></div><div class="line number123 index122 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"\nTesting create User API----------"</code><code class="java plain">);</code></div><div class="line number124 index123 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate();</code></div><div class="line number125 index124 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">User user = </code><code class="java keyword">new</code> <code class="java plain">User(</code><code class="java value">0</code><code class="java plain">,</code><code class="java string">"Sarah"</code><code class="java plain">,</code><code class="java value">51</code><code class="java plain">,</code><code class="java value">134</code><code class="java plain">);</code></div><div class="line number126 index125 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;Object&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;Object&gt;(user, getHeaders());</code></div><div class="line number127 index126 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">URI uri = restTemplate.postForLocation(REST_SERVICE_URI+</code><code class="java string">"/user/"</code><code class="java plain">+QPM_ACCESS_TOKEN+tokenInfo.getAccess_token(),</code></div><div class="line number128 index127 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">request, User.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number129 index128 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"Location : "</code><code class="java plain">+uri.toASCIIString());</code></div><div class="line number130 index129 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number131 index130 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number132 index131 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number133 index132 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a PUT request to update an existing user.</code></div><div class="line number134 index133 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number135 index134 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">updateUser(AuthTokenInfo tokenInfo) {</code></div><div class="line number136 index135 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Assert.notNull(tokenInfo, </code><code class="java string">"Authenticate first please......"</code><code class="java plain">);</code></div><div class="line number137 index136 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"\nTesting update User API----------"</code><code class="java plain">);</code></div><div class="line number138 index137 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate();</code></div><div class="line number139 index138 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">User user&nbsp; = </code><code class="java keyword">new</code> <code class="java plain">User(</code><code class="java value">1</code><code class="java plain">,</code><code class="java string">"Tomy"</code><code class="java plain">,</code><code class="java value">33</code><code class="java plain">, </code><code class="java value">70000</code><code class="java plain">);</code></div><div class="line number140 index139 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;Object&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;Object&gt;(user, getHeaders());</code></div><div class="line number141 index140 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ResponseEntity&lt;User&gt; response = restTemplate.exchange(REST_SERVICE_URI+</code><code class="java string">"/user/1"</code><code class="java plain">+QPM_ACCESS_TOKEN+tokenInfo.getAccess_token(),</code></div><div class="line number142 index141 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpMethod.PUT, request, User.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number143 index142 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(response.getBody());</code></div><div class="line number144 index143 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number145 index144 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number146 index145 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number147 index146 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a DELETE request to delete a specific user.</code></div><div class="line number148 index147 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number149 index148 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">deleteUser(AuthTokenInfo tokenInfo) {</code></div><div class="line number150 index149 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Assert.notNull(tokenInfo, </code><code class="java string">"Authenticate first please......"</code><code class="java plain">);</code></div><div class="line number151 index150 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"\nTesting delete User API----------"</code><code class="java plain">);</code></div><div class="line number152 index151 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate();</code></div><div class="line number153 index152 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;String&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;String&gt;(getHeaders());</code></div><div class="line number154 index153 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">restTemplate.exchange(REST_SERVICE_URI+</code><code class="java string">"/user/3"</code><code class="java plain">+QPM_ACCESS_TOKEN+tokenInfo.getAccess_token(),</code></div><div class="line number155 index154 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpMethod.DELETE, request, User.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number156 index155 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number157 index156 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number158 index157 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number159 index158 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">/*</code></div><div class="line number160 index159 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">* Send a DELETE request to delete all users.</code></div><div class="line number161 index160 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">*/</code></div><div class="line number162 index161 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">deleteAllUsers(AuthTokenInfo tokenInfo) {</code></div><div class="line number163 index162 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Assert.notNull(tokenInfo, </code><code class="java string">"Authenticate first please......"</code><code class="java plain">);</code></div><div class="line number164 index163 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.out.println(</code><code class="java string">"\nTesting all delete Users API----------"</code><code class="java plain">);</code></div><div class="line number165 index164 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RestTemplate restTemplate = </code><code class="java keyword">new</code> <code class="java plain">RestTemplate();</code></div><div class="line number166 index165 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpEntity&lt;String&gt; request = </code><code class="java keyword">new</code> <code class="java plain">HttpEntity&lt;String&gt;(getHeaders());</code></div><div class="line number167 index166 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">restTemplate.exchange(REST_SERVICE_URI+</code><code class="java string">"/user/"</code><code class="java plain">+QPM_ACCESS_TOKEN+tokenInfo.getAccess_token(),</code></div><div class="line number168 index167 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">HttpMethod.DELETE, request, User.</code><code class="java keyword">class</code><code class="java plain">);</code></div><div class="line number169 index168 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number170 index169 alt1"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number171 index170 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">main(String args[]){</code></div><div class="line number172 index171 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">AuthTokenInfo tokenInfo = sendTokenRequest();</code></div><div class="line number173 index172 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">listAllUsers(tokenInfo);</code></div><div class="line number174 index173 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number175 index174 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">getUser(tokenInfo);</code></div><div class="line number176 index175 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number177 index176 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">createUser(tokenInfo);</code></div><div class="line number178 index177 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">listAllUsers(tokenInfo);</code></div><div class="line number179 index178 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number180 index179 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">updateUser(tokenInfo);</code></div><div class="line number181 index180 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">listAllUsers(tokenInfo);</code></div><div class="line number182 index181 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number183 index182 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">deleteUser(tokenInfo);</code></div><div class="line number184 index183 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">listAllUsers(tokenInfo);</code></div><div class="line number185 index184 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number186 index185 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">deleteAllUsers(tokenInfo);</code></div><div class="line number187 index186 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">listAllUsers(tokenInfo);</code></div><div class="line number188 index187 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number189 index188 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Above code will produce following output:</p>
<div><div id="highlighter_437248" class="syntaxhighlighter nogutter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">AuthTokenInfo [access_token=fceed386-5923-4bf8-b193-1d76f95da4c4, token_type=bearer, refresh_token=29d28ee2-9d09-483f-a2d6-7f93e7a31667, expires_in=71, scope=read write trust]</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="xml plain">Testing listAllUsers API-----------</code></div><div class="line number4 index3 alt1"><code class="xml plain">User : id=1, Name=Sam, Age=30, Salary=70000.0</code></div><div class="line number5 index4 alt2"><code class="xml plain">User : id=2, Name=Tom, Age=40, Salary=50000.0</code></div><div class="line number6 index5 alt1"><code class="xml plain">User : id=3, Name=Jerome, Age=45, Salary=30000.0</code></div><div class="line number7 index6 alt2"><code class="xml plain">User : id=4, Name=Silvia, Age=50, Salary=40000.0</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="xml plain">Testing getUser API----------</code></div><div class="line number10 index9 alt1"><code class="xml plain">User [id=1, name=Sam, age=30, salary=70000.0]</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="xml plain">Testing create User API----------</code></div><div class="line number13 index12 alt2"><code class="xml plain">Location : <a href="http://localhost:8080/SpringSecurityOAuth2Example/user/5">http://localhost:8080/SpringSecurityOAuth2Example/user/5</a></code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="xml plain">Testing listAllUsers API-----------</code></div><div class="line number16 index15 alt1"><code class="xml plain">User : id=1, Name=Sam, Age=30, Salary=70000.0</code></div><div class="line number17 index16 alt2"><code class="xml plain">User : id=2, Name=Tom, Age=40, Salary=50000.0</code></div><div class="line number18 index17 alt1"><code class="xml plain">User : id=3, Name=Jerome, Age=45, Salary=30000.0</code></div><div class="line number19 index18 alt2"><code class="xml plain">User : id=4, Name=Silvia, Age=50, Salary=40000.0</code></div><div class="line number20 index19 alt1"><code class="xml plain">User : id=5, Name=Sarah, Age=51, Salary=134.0</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="xml plain">Testing update User API----------</code></div><div class="line number23 index22 alt2"><code class="xml plain">User [id=1, name=Tomy, age=33, salary=70000.0]</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="xml plain">Testing listAllUsers API-----------</code></div><div class="line number26 index25 alt1"><code class="xml plain">User : id=1, Name=Tomy, Age=33, Salary=70000.0</code></div><div class="line number27 index26 alt2"><code class="xml plain">User : id=2, Name=Tom, Age=40, Salary=50000.0</code></div><div class="line number28 index27 alt1"><code class="xml plain">User : id=3, Name=Jerome, Age=45, Salary=30000.0</code></div><div class="line number29 index28 alt2"><code class="xml plain">User : id=4, Name=Silvia, Age=50, Salary=40000.0</code></div><div class="line number30 index29 alt1"><code class="xml plain">User : id=5, Name=Sarah, Age=51, Salary=134.0</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="xml plain">Testing delete User API----------</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="xml plain">Testing listAllUsers API-----------</code></div><div class="line number35 index34 alt2"><code class="xml plain">User : id=1, Name=Tomy, Age=33, Salary=70000.0</code></div><div class="line number36 index35 alt1"><code class="xml plain">User : id=2, Name=Tom, Age=40, Salary=50000.0</code></div><div class="line number37 index36 alt2"><code class="xml plain">User : id=4, Name=Silvia, Age=50, Salary=40000.0</code></div><div class="line number38 index37 alt1"><code class="xml plain">User : id=5, Name=Sarah, Age=51, Salary=134.0</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="xml plain">Testing all delete Users API----------</code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="xml plain">Testing listAllUsers API-----------</code></div><div class="line number43 index42 alt2"><code class="xml plain">No user exist----------</code></div></div></td></tr></tbody></table></div></div>
<h3>Project Structure</h3>
<p><img src="./Secure Spring REST API using OAuth2 - WebSystique_files/SpringOAuth2_img10.png" alt="SpringOAuth2_img10" width="362" height="524" class="aligncenter size-full wp-image-2914"></p>
<h3>pom.xml</h3>
<div><div id="highlighter_61294" class="syntaxhighlighter nogutter  xml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">project</code> <code class="xml color1">xmlns</code><code class="xml plain">=</code><code class="xml string">"<a href="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</a>"</code> <code class="xml color1">xmlns:xsi</code><code class="xml plain">=</code><code class="xml string">"<a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>"</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml color1">xsi:schemaLocation</code><code class="xml plain">=</code><code class="xml string">"<a href="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</a> <a href="http://maven.apache.org/xsd/maven-4.0.0.xsd">http://maven.apache.org/xsd/maven-4.0.0.xsd</a>"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">modelVersion</code><code class="xml plain">&gt;4.0.0&lt;/</code><code class="xml keyword">modelVersion</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;com.websystique.springmvc&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;SpringSecurityOAuth2Example&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;1.0.0&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">packaging</code><code class="xml plain">&gt;war&lt;/</code><code class="xml keyword">packaging</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">name</code><code class="xml plain">&gt;SpringSecurityOAuth2Example&lt;/</code><code class="xml keyword">name</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">properties</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">project.build.sourceEncoding</code><code class="xml plain">&gt;UTF-8&lt;/</code><code class="xml keyword">project.build.sourceEncoding</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">springframework.version</code><code class="xml plain">&gt;4.3.1.RELEASE&lt;/</code><code class="xml keyword">springframework.version</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">springsecurity.version</code><code class="xml plain">&gt;4.1.1.RELEASE&lt;/</code><code class="xml keyword">springsecurity.version</code><code class="xml plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">springsecurityoauth2.version</code><code class="xml plain">&gt;2.0.10.RELEASE&lt;/</code><code class="xml keyword">springsecurityoauth2.version</code><code class="xml plain">&gt;</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">jackson.library</code><code class="xml plain">&gt;2.7.5&lt;/</code><code class="xml keyword">jackson.library</code><code class="xml plain">&gt;</code></div><div class="line number18 index17 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">properties</code><code class="xml plain">&gt;</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependencies</code><code class="xml plain">&gt;</code></div><div class="line number21 index20 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- Spring --&gt;</code></div><div class="line number22 index21 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number23 index22 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.springframework&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number24 index23 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;spring-core&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number25 index24 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${springframework.version}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number26 index25 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number27 index26 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number28 index27 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.springframework&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number29 index28 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;spring-web&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number30 index29 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${springframework.version}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number31 index30 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number32 index31 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number33 index32 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.springframework&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number34 index33 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;spring-webmvc&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number35 index34 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${springframework.version}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number36 index35 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- Spring Security --&gt;</code></div><div class="line number39 index38 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number40 index39 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.springframework.security&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number41 index40 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;spring-security-web&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number42 index41 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${springsecurity.version}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number43 index42 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number44 index43 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number45 index44 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.springframework.security&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number46 index45 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;spring-security-config&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number47 index46 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${springsecurity.version}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number48 index47 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- Spring Security OAuth2--&gt;</code></div><div class="line number51 index50 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number52 index51 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.springframework.security.oauth&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number53 index52 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;spring-security-oauth2&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number54 index53 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${springsecurityoauth2.version}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number55 index54 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number56 index55 alt1">&nbsp;</div><div class="line number57 index56 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- Jackson libraries --&gt;</code></div><div class="line number58 index57 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number59 index58 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;com.fasterxml.jackson.core&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number60 index59 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;jackson-databind&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number61 index60 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${jackson.library}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number62 index61 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number63 index62 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number64 index63 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;com.fasterxml.jackson.dataformat&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number65 index64 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;jackson-dataformat-xml&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number66 index65 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;${jackson.library}&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number67 index66 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number68 index67 alt1">&nbsp;</div><div class="line number69 index68 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number70 index69 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;javax.servlet&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number71 index70 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;javax.servlet-api&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number72 index71 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;3.1.0&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number73 index72 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number74 index73 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">dependencies</code><code class="xml plain">&gt;</code></div><div class="line number75 index74 alt2">&nbsp;</div><div class="line number76 index75 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">build</code><code class="xml plain">&gt;</code></div><div class="line number77 index76 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">plugins</code><code class="xml plain">&gt;</code></div><div class="line number78 index77 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">plugin</code><code class="xml plain">&gt;</code></div><div class="line number79 index78 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.apache.maven.plugins&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number80 index79 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;maven-compiler-plugin&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number81 index80 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;3.2&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number82 index81 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">configuration</code><code class="xml plain">&gt;</code></div><div class="line number83 index82 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">source</code><code class="xml plain">&gt;1.7&lt;/</code><code class="xml keyword">source</code><code class="xml plain">&gt;</code></div><div class="line number84 index83 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">target</code><code class="xml plain">&gt;1.7&lt;/</code><code class="xml keyword">target</code><code class="xml plain">&gt;</code></div><div class="line number85 index84 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">configuration</code><code class="xml plain">&gt;</code></div><div class="line number86 index85 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">plugin</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number87 index86 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">plugin</code><code class="xml plain">&gt;</code></div><div class="line number88 index87 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;org.apache.maven.plugins&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number89 index88 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;maven-war-plugin&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number90 index89 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;2.4&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number91 index90 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">configuration</code><code class="xml plain">&gt;</code></div><div class="line number92 index91 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">warSourceDirectory</code><code class="xml plain">&gt;src/main/webapp&lt;/</code><code class="xml keyword">warSourceDirectory</code><code class="xml plain">&gt;</code></div><div class="line number93 index92 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">warName</code><code class="xml plain">&gt;SpringSecurityOAuth2Example&lt;/</code><code class="xml keyword">warName</code><code class="xml plain">&gt;</code></div><div class="line number94 index93 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">failOnMissingWebXml</code><code class="xml plain">&gt;false&lt;/</code><code class="xml keyword">failOnMissingWebXml</code><code class="xml plain">&gt;</code></div><div class="line number95 index94 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">configuration</code><code class="xml plain">&gt;</code></div><div class="line number96 index95 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">plugin</code><code class="xml plain">&gt;</code></div><div class="line number97 index96 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">plugins</code><code class="xml plain">&gt;</code></div><div class="line number98 index97 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">finalName</code><code class="xml plain">&gt;SpringSecurityOAuth2Example&lt;/</code><code class="xml keyword">finalName</code><code class="xml plain">&gt;</code></div><div class="line number99 index98 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">build</code><code class="xml plain">&gt;</code></div><div class="line number100 index99 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">project</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div>
<h4><i><u>Download Source Code</u></i></h4>
<p></p><div class="sdm_download_link"><a href="http://websystique.com/?smd_process_download=1&amp;download_id=2926" class="sdm_download darkblue" title="Secure Spring REST API with OAuth2">Download Now!</a></div><br>
<br><p></p>
<h4>References</h4>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6749" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://tools.ietf.org/html/rfc6749&#39;, &#39;OAuth2 Specification&#39;]);">OAuth2 Specification</a></li>
<li><a href="http://projects.spring.io/spring-security-oauth/" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;http://projects.spring.io/spring-security-oauth/&#39;, &#39;Spring OAuth2 Official reference&#39;]);">Spring OAuth2 Official reference</a></li>
<li><a href="http://projects.spring.io/spring-security/" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;http://projects.spring.io/spring-security/&#39;, &#39;Spring Security 4 Project Page&#39;]);">Spring Security 4 Project Page</a></li>
<li><a href="http://docs.spring.io/spring-security/site/docs/4.0.1.RELEASE/reference/htmlsingle/" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;http://docs.spring.io/spring-security/site/docs/4.0.1.RELEASE/reference/htmlsingle/&#39;, &#39;Spring Security 4 Reference Manual&#39;]);">Spring Security 4 Reference Manual</a></li>
</ul>
<div class="saboxplugin-wrap">
<div class="saboxplugin-gravatar"><img alt="" src="./Secure Spring REST API using OAuth2 - WebSystique_files/349d343430a189b4fe26c3553a0c752a" class="avatar avatar-100 photo" height="100" width="100"></div>
<div class="saboxplugin-authorname"><a href="http://websystique.com/author/blogadminuser/">websystiqueadmin</a></div>
<div class="saboxplugin-desc">
<div class="vcard author"><span class="fn">If you like tutorials on this site,  why not take a step further and connect me on  <a href="https://www.facebook.com/websystique" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://www.facebook.com/websystique&#39;, &#39;Facebook&#39;]);">Facebook</a> , <a href="https://plus.google.com/+WebsystiqueDotCom/posts" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://plus.google.com/+WebsystiqueDotCom/posts&#39;, &#39;Google Plus&#39;]);">Google Plus</a>  &amp; <a href="https://twitter.com/Websystique" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://twitter.com/Websystique&#39;, &#39;Twitter&#39;]);">Twitter</a> as well?  I would love to hear your thoughts on these articles, it will help me improve further our learning process.<p></p>
<p>If you appreciate the effort I have put in this learning site, help me improve the visibility of this site towards global audience by sharing and linking this site from within and beyond your network.  You &amp; your friends can always link my site from your site on  <a href="http://www.websystique.com/">www.websystique.com</a>, and share the learning.</p>
<p>After all,  we are here to learn together, aren’t we?</p></span></div>
</div>
<div class="clearfix"></div>
<div class="saboxplugin-socials sabox-colored"><a href="https://www.facebook.com/websystique" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://www.facebook.com/websystique&#39;, &#39;&#39;]);" target="_self"><span class="saboxplugin-icon-color saboxplugin-icon-facebook"></span></a><a href="https://plus.google.com/+WebsystiqueDotCom/posts" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://plus.google.com/+WebsystiqueDotCom/posts&#39;, &#39;&#39;]);" target="_self"><span class="saboxplugin-icon-color saboxplugin-icon-googleplus"></span></a><a href="https://twitter.com/Websystique" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-article&#39;, &#39;https://twitter.com/Websystique&#39;, &#39;&#39;]);" target="_self"><span class="saboxplugin-icon-color saboxplugin-icon-twitter"></span></a></div>
</div>

<div style="font-size:0px;height:0px;line-height:0px;margin:0;padding:0;clear:both"></div><div class="yarpp-related">
<h3>Related posts:</h3><ol>
<li><a href="http://websystique.com/spring-security/secure-spring-rest-api-using-basic-authentication/" rel="bookmark" title="Secure Spring REST API using Basic Authentication">Secure Spring REST API using Basic Authentication </a></li>
<li><a href="http://websystique.com/spring-security/spring-security-4-secure-view-layer-using-taglibs/" rel="bookmark" title="Spring Security 4 Secure View Fragments using taglibs">Spring Security 4 Secure View Fragments using taglibs </a></li>
<li><a href="http://websystique.com/springmvc/spring-4-mvc-rest-service-example-using-restcontroller/" rel="bookmark" title="Spring 4 MVC REST Service Example using @RestController">Spring 4 MVC REST Service Example using @RestController </a></li>
<li><a href="http://websystique.com/springmvc/spring-mvc-requestbody-responsebody-example/" rel="bookmark" title="Spring MVC @RequestBody @ResponseBody Example">Spring MVC @RequestBody @ResponseBody Example </a></li>
</ol>
</div>
			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<i class="dashicons dashicons-category"></i> <a href="http://websystique.com/category/spring-security/" title="View all posts in spring-security" rel="category tag">spring-security</a>. <i class="dashicons dashicons-admin-links"></i> <a href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/" rel="bookmark">permalink</a>.
			</footer><!-- .entry-footer -->
</article><!-- #post-## -->

				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<div class="nav-previous"><a href="http://websystique.com/spring-security/angularjs-basic-authentication-using-spring-security/" rel="prev"><span class="meta-nav">←</span> AngularJS+Spring Security using Basic Authentication</a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="disqus_thread"><iframe id="dsq-app4" name="dsq-app4" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Secure Spring REST API using OAuth2 - WebSystique_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 0px !important; display: none !important;"></iframe><iframe id="dsq-app1" name="dsq-app1" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Secure Spring REST API using OAuth2 - WebSystique_files/saved_resource(1).html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 11148px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 847px !important; border: none !important; overflow: hidden !important; top: 0px !important; min-width: 847px !important; max-width: 847px !important; position: fixed !important; z-index: 2147483646 !important; height: 18px !important; min-height: 18px !important; max-height: 18px !important; display: none !important;" src="./Secure Spring REST API using OAuth2 - WebSystique_files/saved_resource(2).html"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 847px !important; border: none !important; overflow: hidden !important; bottom: 0px !important; min-width: 847px !important; max-width: 847px !important; position: fixed !important; z-index: 2147483646 !important; height: 18px !important; min-height: 18px !important; max-height: 18px !important; display: none !important;" src="./Secure Spring REST API using OAuth2 - WebSystique_files/saved_resource(3).html"></iframe></div>

<script type="text/javascript">
var disqus_url = 'http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/';
var disqus_identifier = '2904 http://websystique.com/?p=2904';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'websystique';
var disqus_title = "Secure Spring REST API using OAuth2";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
        this.callbacks.onReady.push(function () {

        // sync comments in the background so we don't block the page
        var script = document.createElement('script');
        script.async = true;
        script.src = '?cf_action=sync_comments&post_id=2904';

        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
    });
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>


		
		</main><!-- #main -->
	</div><!-- #primary -->

<div id="content-border"></div>
	<div id="secondary" class="widget-area" role="complementary">
		<aside id="sfp_page_plugin_widget-2" class="widget widget_sfp_page_plugin_widget"><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Secure Spring REST API using OAuth2 - WebSystique_files/_IDqWBiKXtV.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Secure Spring REST API using OAuth2 - WebSystique_files/_IDqWBiKXtV(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
<script>
	(function(d){
		var js, id = 'facebook-jssdk';
		if (d.getElementById(id)) {return;}
		js = d.createElement('script');
		js.id = id;
		js.async = true;
		js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
		d.getElementsByTagName('head')[0].appendChild(js);
	}(document));
</script>
<!-- SFPlugin by topdevs -->
<!-- Page Plugin Code START -->
<div class="sfp-container">
	<div class="fb-page fb_iframe_widget" data-href="http://www.facebook.com/websystique" data-width="271" data-height="" data-hide-cover="false" data-show-facepile="false" data-show-posts="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;container_width=309&amp;hide_cover=false&amp;href=http%3A%2F%2Fwww.facebook.com%2Fwebsystique&amp;locale=en_US&amp;sdk=joey&amp;show_facepile=false&amp;show_posts=false&amp;width=271"><span style="vertical-align: bottom; width: 271px; height: 130px;"><iframe name="f1ec9da00162d48" width="271px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:page Facebook Social Plugin" src="./Secure Spring REST API using OAuth2 - WebSystique_files/page.html" style="border: none; visibility: visible; width: 271px; height: 130px;" class=""></iframe></span></div>
</div>
<!-- Page Plugin Code END --></aside>
<!-- Quick Adsense Wordpress Plugin: http://quicksense.net/ -->
<aside id="adswidget2-quick-adsense" class="widget �lambda_149">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad-5 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-6696898840465221" data-ad-slot="5225991592"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</aside><aside id="google-badge-box-2" class="widget mts_googleplus">	
			<div id="___page_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 273px; height: 105px;"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 273px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 105px;" tabindex="0" vspace="0" width="100%" id="I0_1481524708505" name="I0_1481524708505" src="./Secure Spring REST API using OAuth2 - WebSystique_files/page(1).html" data-gapiattached="true" title="+Badge"></iframe></div>
			<!-- Place this tag after the last badgev2 tag. -->
			<script type="text/javascript">
			  (function() {
				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
				po.src = 'https://apis.google.com/js/plusone.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
			  })();
			</script>
		</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/">Secure Spring REST API using OAuth2</a>
						</li>
					<li>
				<a href="http://websystique.com/spring-security/angularjs-basic-authentication-using-spring-security/">AngularJS+Spring Security using Basic Authentication</a>
						</li>
					<li>
				<a href="http://websystique.com/spring-security/secure-spring-rest-api-using-basic-authentication/">Secure Spring REST API using Basic Authentication</a>
						</li>
					<li>
				<a href="http://websystique.com/spring/spring-4-cacheable-cacheput-cacheevict-caching-cacheconfig-enablecaching-tutorial/">Spring 4 Caching Annotations Tutorial</a>
						</li>
					<li>
				<a href="http://websystique.com/spring/spring-4-cache-tutorial-with-ehcache/">Spring 4 Cache Tutorial with EhCache</a>
						</li>
				</ul>
		</aside>
<!-- Quick Adsense Wordpress Plugin: http://quicksense.net/ -->
<aside id="adswidget1-quick-adsense" class="widget �lambda_148">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad-4 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-6696898840465221" data-ad-slot="6842325590"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</aside>
<!-- Quick Adsense Wordpress Plugin: http://quicksense.net/ -->
<aside id="adswidget3-quick-adsense" class="widget �lambda_150">
<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Ad-6 -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6696898840465221" data-ad-slot="5086390794" data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</aside>	<div class="googlepublisherpluginad" style="text-align: center; width: 100%; height: auto; clear: none;"><ins data-ad-format="auto" class="adsbygoogle" data-ad-client="ca-pub-6696898840465221" data-tag-origin="pso" data-ad-slot="9313790394" data-ad-channel="WordPressSinglePost" data-adsbygoogle-status="reserved" style="display: block; margin: 10px auto; background-color: transparent;"></ins></div></div><!-- #secondary -->

	</div><!-- #content -->
	<footer id="colophon" class="site-footer" role="contentinfo">
					<div class="site-info">
				Copyright © 2014-2016 WebSystique.com. All rights reserved.			</div><!-- .site-info -->
			</footer><!-- #colophon -->
</div><!-- #page -->

        <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'websystique';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); 
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script>
        <script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/shCore.js.download"></script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/shBrushJava.js.download"></script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/shBrushXml.js.download"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://websystique.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://websystique.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel="stylesheet" id="basecss-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="yarppRelatedCss-css" href="./Secure Spring REST API using OAuth2 - WebSystique_files/related.css" type="text/css" media="all">
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/navigation.js.download"></script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/skip-link-focus-fix.js.download"></script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/comment-reply.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var eucookielaw_data = {"euCookieSet":null,"autoBlock":"0","expireTimer":"0","scrollConsent":"0","networkShareURL":"","isCookiePage":"","isRefererWebsite":"","deleteCookieUrl":"http:\/\/websystique.com\/spring-security\/secure-spring-rest-api-using-oauth2\/?nocookie=1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Secure Spring REST API using OAuth2 - WebSystique_files/scripts.js.download"></script>
        <!-- Eu Cookie Law 2.7 -->
        <div class="pea_cook_wrapper pea_cook_bottomleft" style="color: rgb(255, 255, 255); background-color: rgba(0, 0, 0, 0.85098); display: none;">
            <p>We use cookies to personalize content and ads, to provide the best browsing experience possible, to provide social media features and to analyse our traffic. We also share information about your use of our site with our social media, advertising and analytics partners. By continuing to use the site, you agree to the use of cookies. <a style="color:#FFFFFF;" href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/#" id="fom">more information</a> <button id="pea_cook_btn" class="pea_cook_btn" href="#">Accept</button></p>
        </div>
        <div class="pea_cook_more_info_popover">
            <div class="pea_cook_more_info_popover_inner" style="
                    color:#FFFFFF;
                    background-color: rgba(0,0,0,0.9);
                    ">
             <p>The cookie settings on this website are set to "allow cookies" to give you the best browsing experience possible. If you continue to use this website without changing your cookie settings or you click "Accept" below then you are consenting to this. Please also look at <a href="https://www.google.com/policies/technologies/cookies/" target="_blank">How Google uses cookies</a> to learn even more.</p>
                <p><a style="color:#FFFFFF;" href="http://websystique.com/spring-security/secure-spring-rest-api-using-oauth2/#" id="pea_close">Close</a></p>
			</div>
        </div>



<iframe style="display: none;" src="./Secure Spring REST API using OAuth2 - WebSystique_files/saved_resource(4).html"></iframe><iframe name="oauth2relay1118326371" id="oauth2relay1118326371" src="./Secure Spring REST API using OAuth2 - WebSystique_files/postmessageRelay.html" tabindex="-1" aria-hidden="true" style="width: 1px; height: 1px; position: absolute; top: -100px;"></iframe><script aria-hidden="true" type="application/x-lastpass" id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{(function() { for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; if (typeof(lastpass_f.lpsubmitorig2)=='object'){ continue;}lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); if (d) {for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ if (typeof(d.innerText) != 'undefined') { d.innerText=i.toString(); } else { d.textContent=i.toString(); } } } d.dispatchEvent(customEvent); }form.lpsubmitorig2(); } } }})()}catch(e){}</script></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>